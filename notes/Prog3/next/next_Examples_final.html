<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>next_Examples</title>
</head>
<body style="font-family: Arial, sans-serif; line-height: 1.6; margin: 0 auto; padding: 20px">
<h1 id="uso-de-next-en-expressjs" style="background-color: #4b0404; color: #e38735; padding: 18px; border-radius: 10px; border: 1px solid #444; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); font-size: 1.8em; font-weight: bold; margin-bottom: 20px; text-align: center">Uso de next() en Express.js</h1>
<div class="toc" id="table-of-contents" style="background-color: #f0f0ff; border-radius: 8px; padding: 20px 30px; margin: 20px 0; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); font-family: Arial, sans-serif; border: 1px solid #d0d0ff">
<h2 id="contents-header" style="text-align: center; color: #585b9e; font-size: 24px; margin-top: 10px; margin-bottom: 20px; font-weight: 500; padding-bottom: 15px">Tabla de contenidos</h2>
<ul class="toc" style="list-style-type: none; padding-left: 20px; margin: 0">
<li class="toc" style="margin: 10px 0; line-height: 1.5; color: #585b9e"><a class="toc" href="#1-uso-basico-de-next" style="text-decoration: none; color: #585b9e; transition: color 0.2s, padding-left 0.2s; display: inline-block; font-weight: 500">1. Uso Básico de next()</a></li>
<li class="toc" style="margin: 10px 0; line-height: 1.5; color: #585b9e"><a class="toc" href="#2-nextroute-saltar-a-la-siguiente-ruta" style="text-decoration: none; color: #585b9e; transition: color 0.2s, padding-left 0.2s; display: inline-block; font-weight: 500">2. next('route') - Saltar a la Siguiente Ruta</a></li>
<li class="toc" style="margin: 10px 0; line-height: 1.5; color: #585b9e"><a class="toc" href="#3-nexterror-manejo-de-errores" style="text-decoration: none; color: #585b9e; transition: color 0.2s, padding-left 0.2s; display: inline-block; font-weight: 500">3. next(error) - Manejo de Errores</a></li>
<li class="toc" style="margin: 10px 0; line-height: 1.5; color: #585b9e"><a class="toc" href="#4-middleware-asincrono-con-next" style="text-decoration: none; color: #585b9e; transition: color 0.2s, padding-left 0.2s; display: inline-block; font-weight: 500">4. Middleware Asíncrono con next()</a></li>
<li class="toc" style="margin: 10px 0; line-height: 1.5; color: #585b9e"><a class="toc" href="#5-cadena-de-middlewares-para-una-ruta" style="text-decoration: none; color: #585b9e; transition: color 0.2s, padding-left 0.2s; display: inline-block; font-weight: 500">5. Cadena de Middlewares para una Ruta</a></li>
<li class="toc" style="margin: 10px 0; line-height: 1.5; color: #585b9e"><a class="toc" href="#6-no-llamar-a-next-o-no-enviar-respuesta" style="text-decoration: none; color: #585b9e; transition: color 0.2s, padding-left 0.2s; display: inline-block; font-weight: 500">6. No llamar a next() o no enviar respuesta</a></li>
<li class="toc" style="margin: 10px 0; line-height: 1.5; color: #585b9e"><a class="toc" href="#7-combinando-distintos-comportamientos-de-next" style="text-decoration: none; color: #585b9e; transition: color 0.2s, padding-left 0.2s; display: inline-block; font-weight: 500">7. Combinando distintos comportamientos de next()</a></li>
</ul>
</div>
<div class="chapter-container" style="background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)"><h2 id="1-uso-basico-de-next" style="margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #444">1. Uso Básico de next()</h2>
<p>Este ejemplo muestra cómo la solicitud fluye a través de varios middlewares utilizando <code style='font-family: "Courier New", Courier, monospace'>next()</code>:</p>
<div class="highlight language-javascript" style="background: #f8f8f8; padding: 0; border-radius: 5px; margin: 15px 0; background-color: #fef6e4; border: 1px solid #f0e6d4; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)"><pre style='line-height: 125%; color: #555; font-weight: normal; font-style: normal; background: none; border: none; box-shadow: none; padding: 12px; margin: 0; border-radius: 0; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; overflow-x: auto; background-color: #fef6e4'><span style='color: #555; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'></span><span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>require</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'express'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware 1: Logger</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`[</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="ow" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>new</span> <span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>Date</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>().</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>toISOString</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>()</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>] </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>method</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'> </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>url</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span> <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Pasa al siguiente middleware</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware 2: Añadir datos a la solicitud</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tiempoInicio</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>Date</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>now</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span> <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Pasa al siguiente middleware</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Ruta específica</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/hello'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tiempoTotal</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>Date</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>now</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>()</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>-</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tiempoInicio</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>;</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`Hello World! (Procesado en </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tiempoTotal</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>ms)`</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// No hay next() porque la respuesta ya fue enviada</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>listen</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>3000</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>()</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Servidor ejecutándose en puerto 3000'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>
</pre></div>
</div><div class="chapter-container" style="background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)"><h2 id="2-nextroute-saltar-a-la-siguiente-ruta" style="margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #444">2. next('route') - Saltar a la Siguiente Ruta</h2>
<p>Este ejemplo demuestra cómo usar <code style='font-family: "Courier New", Courier, monospace'>next('route')</code> para saltar a la siguiente definición de ruta:</p>
<div class="highlight language-javascript" style="background: #f8f8f8; padding: 0; border-radius: 5px; margin: 15px 0; background-color: #fef6e4; border: 1px solid #f0e6d4; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)"><pre style='line-height: 125%; color: #555; font-weight: normal; font-style: normal; background: none; border: none; box-shadow: none; padding: 12px; margin: 0; border-radius: 0; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; overflow-x: auto; background-color: #fef6e4'><span style='color: #555; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'></span><span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>require</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'express'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Definición de ruta con múltiples controladores</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/usuario/:id'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span>
  <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware para verificar si el usuario es administrador</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>params</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>===</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'admin'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
      <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Si es admin, salta a la siguiente definición de ruta</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'route'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
    <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>else</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
      <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Si no es admin, continúa con el siguiente middleware</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
    <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>},</span>
  <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Este middleware solo se ejecuta para usuarios no admin</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`Usuario regular: </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>params</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Esta es la siguiente definición de ruta (se ejecuta si se llama a next('route'))</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/usuario/:id'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Panel de administrador'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>listen</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>3000</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
</pre></div>
</div><div class="chapter-container" style="background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)"><h2 id="3-nexterror-manejo-de-errores" style="margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #444">3. next(error) - Manejo de Errores</h2>
<p>Muestra cómo pasar errores a un middleware especial para manejarlos:</p>
<div class="highlight language-javascript" style="background: #f8f8f8; padding: 0; border-radius: 5px; margin: 15px 0; background-color: #fef6e4; border: 1px solid #f0e6d4; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)"><pre style='line-height: 125%; color: #555; font-weight: normal; font-style: normal; background: none; border: none; box-shadow: none; padding: 12px; margin: 0; border-radius: 0; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; overflow-x: auto; background-color: #fef6e4'><span style='color: #555; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'></span><span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>require</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'express'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware que podría generar un error</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/division/:numerador/:denominador'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>numerador</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>parseInt</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>params</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>numerador</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>denominador</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>parseInt</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>params</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>denominador</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>

  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>denominador</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>===</span> <span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>0</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Pasamos un error al siguiente middleware de manejo de errores</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="ow" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>new</span> <span class="ne" style='color: #555; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>Error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'No se puede dividir por cero'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>));</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>else</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`Resultado: </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>numerador</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>/</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>denominador</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware de manejo de errores (SIEMPRE tiene 4 parámetros)</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>stack</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>status</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>500</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>).</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`Error: </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>message</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>listen</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>3000</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
</pre></div>
</div><div class="chapter-container" style="background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)"><h2 id="4-middleware-asincrono-con-next" style="margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #444">4. Middleware Asíncrono con next()</h2>
<p>Ejemplo de cómo manejar operaciones asíncronas correctamente con <code style='font-family: "Courier New", Courier, monospace'>next()</code>:</p>
<div class="highlight language-javascript" style="background: #f8f8f8; padding: 0; border-radius: 5px; margin: 15px 0; background-color: #fef6e4; border: 1px solid #f0e6d4; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)"><pre style='line-height: 125%; color: #555; font-weight: normal; font-style: normal; background: none; border: none; box-shadow: none; padding: 12px; margin: 0; border-radius: 0; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; overflow-x: auto; background-color: #fef6e4'><span style='color: #555; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'></span><span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>require</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'express'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Simulación de una función que obtiene datos de forma asíncrona</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>function</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>obtenerDatosDeBaseDeDatos</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>return</span> <span class="ow" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>new</span> <span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>Promise</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>resolve</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>reject</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>setTimeout</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(()</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
      <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>&lt;=</span> <span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>0</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
        <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>reject</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="ow" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>new</span> <span class="ne" style='color: #555; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>Error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'ID no válido'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>));</span>
      <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>else</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
        <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>resolve</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>({</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>nombre</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`Usuario </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>
      <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
    <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>},</span> <span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>500</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware que maneja una operación asíncrona</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/usuario/:id'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>async</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>try</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>parseInt</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>params</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
    <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>usuario</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>await</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>obtenerDatosDeBaseDeDatos</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>json</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>usuario</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>catch</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Pasar el error al middleware de manejo de errores</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware de manejo de errores</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>status</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>500</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>).</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>json</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>({</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>message</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>listen</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>3000</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
</pre></div>
</div><div class="chapter-container" style="background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)"><h2 id="5-cadena-de-middlewares-para-una-ruta" style="margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #444">5. Cadena de Middlewares para una Ruta</h2>
<p>Ejemplo que muestra una cadena de middlewares aplicados a una ruta específica:</p>
<div class="highlight language-javascript" style="background: #f8f8f8; padding: 0; border-radius: 5px; margin: 15px 0; background-color: #fef6e4; border: 1px solid #f0e6d4; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)"><pre style='line-height: 125%; color: #555; font-weight: normal; font-style: normal; background: none; border: none; box-shadow: none; padding: 12px; margin: 0; border-radius: 0; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; overflow-x: auto; background-color: #fef6e4'><span style='color: #555; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'></span><span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>require</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'express'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware para validar parámetros</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>validarParametros</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>parseInt</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>params</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nb" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>isNaN</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>||</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>&lt;=</span> <span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>0</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>return</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>status</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>400</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>).</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'ID debe ser un número positivo'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
  <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Modificar el objeto req para facilitar el uso posterior</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>validatedId</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>id</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>;</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>};</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware para autenticación</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>autenticar</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>token</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>headers</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>authorization</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>;</span>
  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>!</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>token</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>return</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>status</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>401</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>).</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Se requiere autenticación'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
  <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Simular verificación de token</span>
  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>token</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>!==</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'token-secreto'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>return</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>status</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>403</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>).</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Token no válido'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>};</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware para verificar permisos</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>verificarPermisos</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Supongamos que el token 'token-secreto' tiene permisos admin</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>esAdmin</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="kc" style='color: #9a5b13; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>true</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>;</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>};</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Aplicar cadena de middlewares a una ruta</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/recurso/:id'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> 
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>validarParametros</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>autenticar</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>verificarPermisos</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>json</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>({</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>mensaje</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Acceso concedido'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>recursoId</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>validatedId</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>esAdmin</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>esAdmin</span>
    <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>

<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>listen</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>3000</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
</pre></div>
</div><div class="chapter-container" style="background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)"><h2 id="6-no-llamar-a-next-o-no-enviar-respuesta" style="margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #444">6. No llamar a next() o no enviar respuesta</h2>
<p>Este ejemplo ilustra qué ocurre si no se llama a <code style='font-family: "Courier New", Courier, monospace'>next()</code> ni se envía una respuesta:</p>
<div class="highlight language-javascript" style="background: #f8f8f8; padding: 0; border-radius: 5px; margin: 15px 0; background-color: #fef6e4; border: 1px solid #f0e6d4; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)"><pre style='line-height: 125%; color: #555; font-weight: normal; font-style: normal; background: none; border: none; box-shadow: none; padding: 12px; margin: 0; border-radius: 0; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; overflow-x: auto; background-color: #fef6e4'><span style='color: #555; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'></span><span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>require</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'express'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware que procesa la solicitud correctamente</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Middleware 1: Siempre se ejecuta'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware con condición que podría no continuar</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Middleware 2: Verifica condición'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>

  <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Si la URL tiene el parámetro "continuar", seguimos adelante</span>
  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>query</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>continuar</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>===</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'true'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Continuando al siguiente middleware'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>else</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'¡ADVERTENCIA! Ni se llama a next() ni se envía respuesta'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
    <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// La solicitud quedará colgada indefinidamente aquí</span>
    <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// El cliente esperará hasta que ocurra un timeout</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Este middleware no se ejecutará si el anterior no llama a next()</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Middleware 3: Generando respuesta'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Respuesta generada con éxito'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Solución: Implementar un timeout para detectar solicitudes colgadas</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>timeout</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>setTimeout</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(()</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>!</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>headersSent</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Solicitud sin respuesta después de 10 segundos'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>status</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>500</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>).</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Timeout del servidor'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
    <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>},</span> <span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>10000</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>

  <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Limpiamos el timeout cuando la respuesta sea enviada</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>on</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'finish'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>()</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>clearTimeout</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>timeout</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>listen</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>3000</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
</pre></div>
</div><div class="chapter-container" style="background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)"><h2 id="7-combinando-distintos-comportamientos-de-next" style="margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #444">7. Combinando distintos comportamientos de next()</h2>
<p>Este ejemplo muestra varios comportamientos de <code style='font-family: "Courier New", Courier, monospace'>next()</code> en una aplicación completa:</p>
<div class="highlight language-javascript" style="background: #f8f8f8; padding: 0; border-radius: 5px; margin: 15px 0; background-color: #fef6e4; border: 1px solid #f0e6d4; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1)"><pre style='line-height: 125%; color: #555; font-weight: normal; font-style: normal; background: none; border: none; box-shadow: none; padding: 12px; margin: 0; border-radius: 0; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; overflow-x: auto; background-color: #fef6e4'><span style='color: #555; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'></span><span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>require</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'express'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware de nivel de aplicación para todas las rutas</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>express</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>json</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>());</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware de registro</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`Solicitud recibida: </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>method</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'> </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>path</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware para verificar API key</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>apiKey</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>headers</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>[</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'x-api-key'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>];</span>

  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>!</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>apiKey</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>return</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="ow" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>new</span> <span class="ne" style='color: #555; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>Error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'API key requerida'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>));</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>

  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>apiKey</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>===</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'clave-secreta'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>usuario</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tipo</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'premium'</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>};</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>else</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>usuario</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tipo</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'básico'</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>};</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>

  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Ruta con decisión de flujo usando next('route')</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/contenido'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>usuario</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tipo</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>===</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'premium'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>();</span> <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Continúa con el siguiente middleware en esta ruta</span>
    <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>else</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
      <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'route'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span> <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Salta a la siguiente definición de esta ruta</span>
    <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>},</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>json</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>({</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tipo</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'premium'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>contenido</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Contenido exclusivo'</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Ruta alternativa (se ejecuta cuando se llama a next('route'))</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/contenido'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>json</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>({</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>tipo</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'básico'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>contenido</span><span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>:</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Contenido básico'</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Ruta que podría generar error</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>get</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'/procesar/:datos'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>try</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="kd" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>const</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>datos</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>params</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>datos</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>;</span>
    <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>if</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>datos</span> <span class="o" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>===</span> <span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'error'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
      <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>throw</span> <span class="ow" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>new</span> <span class="ne" style='color: #555; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>Error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Error de procesamiento'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
    <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`Datos procesados: </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>datos</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span> <span class="k" style='color: #b05050; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>catch</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
    <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span> <span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Pasar al middleware de error</span>
  <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware para manejar rutas no encontradas (se ejecuta si no hay coincidencia)</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>status</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>404</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>).</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Ruta no encontrada'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="c1" style='color: #52589a; font-weight: normal; font-style: italic; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>// Middleware de manejo de errores (siempre al final)</span>
<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>use</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>((</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>req</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>next</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>)</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>error</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Error:'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>message</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>res</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>status</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>500</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>).</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>send</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`Ocurrió un error: </span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>${</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>err</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>message</span><span class="si" style='color: #327d41; font-weight: bold; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>}</span><span class="sb" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>`</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>

<span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>app</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>listen</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="mf" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>3000</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>,</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>()</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>=&gt;</span> <span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>{</span>
  <span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>console</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>.</span><span class="nx" style='color: #606060; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>log</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>(</span><span class="s1" style='color: #327d41; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>'Servidor iniciado en puerto 3000'</span><span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>);</span>
<span class="p" style='color: #666; font-weight: normal; font-style: normal; font-family: "Consolas", "Menlo", "Monaco", monospace; font-size: 0.95em; line-height: 1.5'>});</span>
</pre></div>
<p>Estos ejemplos ilustran los diferentes casos de uso y comportamientos de la función <code style='font-family: "Courier New", Courier, monospace'>next()</code> en Express.js. Recuerda que siempre debes llamar a <code style='font-family: "Courier New", Courier, monospace'>next()</code> o enviar una respuesta con métodos como <code style='font-family: "Courier New", Courier, monospace'>res.send()</code> o <code style='font-family: "Courier New", Courier, monospace'>res.json()</code> para evitar que las solicitudes queden colgadas.</p></div>
</body>
</html>
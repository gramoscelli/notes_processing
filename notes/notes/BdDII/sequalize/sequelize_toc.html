<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sequelize</title>
    <style>
pre { line-height: 125%; }
td.linenos .normal { color: #f1fa8c; background-color: #44475a; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #f1fa8c; background-color: #44475a; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #50fa7b; background-color: #6272a4; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #50fa7b; background-color: #6272a4; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #44475a }
.highlight { background: #282a36; color: #f8f8f2 }
.highlight .c { color: #6272a4 } /* Comment */
.highlight .err { color: #f8f8f2 } /* Error */
.highlight .g { color: #f8f8f2 } /* Generic */
.highlight .k { color: #ff79c6 } /* Keyword */
.highlight .l { color: #f8f8f2 } /* Literal */
.highlight .n { color: #f8f8f2 } /* Name */
.highlight .o { color: #ff79c6 } /* Operator */
.highlight .x { color: #f8f8f2 } /* Other */
.highlight .p { color: #f8f8f2 } /* Punctuation */
.highlight .ch { color: #6272a4 } /* Comment.Hashbang */
.highlight .cm { color: #6272a4 } /* Comment.Multiline */
.highlight .cp { color: #ff79c6 } /* Comment.Preproc */
.highlight .cpf { color: #6272a4 } /* Comment.PreprocFile */
.highlight .c1 { color: #6272a4 } /* Comment.Single */
.highlight .cs { color: #6272a4 } /* Comment.Special */
.highlight .gd { color: #8b080b } /* Generic.Deleted */
.highlight .ge { color: #f8f8f2; text-decoration: underline } /* Generic.Emph */
.highlight .gr { color: #f8f8f2 } /* Generic.Error */
.highlight .gh { color: #f8f8f2; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #f8f8f2; font-weight: bold } /* Generic.Inserted */
.highlight .go { color: #44475a } /* Generic.Output */
.highlight .gp { color: #f8f8f2 } /* Generic.Prompt */
.highlight .gs { color: #f8f8f2 } /* Generic.Strong */
.highlight .gu { color: #f8f8f2; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #f8f8f2 } /* Generic.Traceback */
.highlight .kc { color: #ff79c6 } /* Keyword.Constant */
.highlight .kd { color: #8be9fd; font-style: italic } /* Keyword.Declaration */
.highlight .kn { color: #ff79c6 } /* Keyword.Namespace */
.highlight .kp { color: #ff79c6 } /* Keyword.Pseudo */
.highlight .kr { color: #ff79c6 } /* Keyword.Reserved */
.highlight .kt { color: #8be9fd } /* Keyword.Type */
.highlight .ld { color: #f8f8f2 } /* Literal.Date */
.highlight .m { color: #ffb86c } /* Literal.Number */
.highlight .s { color: #bd93f9 } /* Literal.String */
.highlight .na { color: #50fa7b } /* Name.Attribute */
.highlight .nb { color: #8be9fd; font-style: italic } /* Name.Builtin */
.highlight .nc { color: #50fa7b } /* Name.Class */
.highlight .no { color: #f8f8f2 } /* Name.Constant */
.highlight .nd { color: #f8f8f2 } /* Name.Decorator */
.highlight .ni { color: #f8f8f2 } /* Name.Entity */
.highlight .ne { color: #f8f8f2 } /* Name.Exception */
.highlight .nf { color: #50fa7b } /* Name.Function */
.highlight .nl { color: #8be9fd; font-style: italic } /* Name.Label */
.highlight .nn { color: #f8f8f2 } /* Name.Namespace */
.highlight .nx { color: #f8f8f2 } /* Name.Other */
.highlight .py { color: #f8f8f2 } /* Name.Property */
.highlight .nt { color: #ff79c6 } /* Name.Tag */
.highlight .nv { color: #8be9fd; font-style: italic } /* Name.Variable */
.highlight .ow { color: #ff79c6 } /* Operator.Word */
.highlight .w { color: #f8f8f2 } /* Text.Whitespace */
.highlight .mb { color: #ffb86c } /* Literal.Number.Bin */
.highlight .mf { color: #ffb86c } /* Literal.Number.Float */
.highlight .mh { color: #ffb86c } /* Literal.Number.Hex */
.highlight .mi { color: #ffb86c } /* Literal.Number.Integer */
.highlight .mo { color: #ffb86c } /* Literal.Number.Oct */
.highlight .sa { color: #bd93f9 } /* Literal.String.Affix */
.highlight .sb { color: #bd93f9 } /* Literal.String.Backtick */
.highlight .sc { color: #bd93f9 } /* Literal.String.Char */
.highlight .dl { color: #bd93f9 } /* Literal.String.Delimiter */
.highlight .sd { color: #bd93f9 } /* Literal.String.Doc */
.highlight .s2 { color: #bd93f9 } /* Literal.String.Double */
.highlight .se { color: #bd93f9 } /* Literal.String.Escape */
.highlight .sh { color: #bd93f9 } /* Literal.String.Heredoc */
.highlight .si { color: #bd93f9 } /* Literal.String.Interpol */
.highlight .sx { color: #bd93f9 } /* Literal.String.Other */
.highlight .sr { color: #bd93f9 } /* Literal.String.Regex */
.highlight .s1 { color: #bd93f9 } /* Literal.String.Single */
.highlight .ss { color: #bd93f9 } /* Literal.String.Symbol */
.highlight .bp { color: #f8f8f2; font-style: italic } /* Name.Builtin.Pseudo */
.highlight .fm { color: #50fa7b } /* Name.Function.Magic */
.highlight .vc { color: #8be9fd; font-style: italic } /* Name.Variable.Class */
.highlight .vg { color: #8be9fd; font-style: italic } /* Name.Variable.Global */
.highlight .vi { color: #8be9fd; font-style: italic } /* Name.Variable.Instance */
.highlight .vm { color: #8be9fd; font-style: italic } /* Name.Variable.Magic */
.highlight .il { color: #ffb86c } /* Literal.Number.Integer.Long */
    </style>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0 auto; padding: 20px; }
        pre { background-color: #1a1a35; color: #f8f8f2; padding: 5px; border-radius: 5px; overflow-x: auto; }
        code { font-family: "Courier New", Courier, monospace; }
        img { max-width: 100%; height: auto; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #f2f2f2; }
        .highlight { padding: 5px; border-radius: 5px; margin: 5px 0; background-color: #1a1a35 !important; }
        .empty-code-block { background-color: #1a1a35; color: #f8f8f2; padding: 5px; border-radius: 5px; margin: 5px 0; font-family: monospace; }
        .highlight-error { background-color: #1a1a35; color: #f08080; padding: 5px; border-radius: 5px; margin: 5px 0; font-family: monospace; }
        .code-block-container { margin: 15px 0; border-radius: 5px; overflow: hidden; }
        .code-block-header { display: flex; justify-content: flex-end; background-color: #2a2a45; color: #f8f8f2; padding: 4px 8px; font-family: monospace; }
        .code-block-toggle { background-color: #3a3a55; color: #f8f8f2; border: none; border-radius: 3px; padding: 2px 8px; cursor: pointer; font-size: 0.85em; }
        .code-block-toggle:hover { background-color: #4a4a65; }
        .code-block-content { transition: max-height 0.3s ease-out; overflow: hidden; }
        .code-block-content.collapsed { max-height: 150px !important; position: relative; overflow: hidden; }
        .code-block-content.collapsed::after { content: "..."; position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(transparent, #1a1a35); text-align: center; padding: 20px 0 5px 0; color: #f8f8f2; }
    </style>
    <style>
        /* CSS from style.css */
body {
    font-family: Century Gothic, Arial, Helvetica, sans-serif;
    line-height: 1.5;
    color: #333;
    max-width: none;
    margin: 0 auto;
    padding: 20px;
}

h1 {
    display: block;
    background-color: #333;
    color: #f78e25;
    font-size: 3em;
    padding: 20px;
    margin-top: 20px;
    margin-bottom: 25px;
    text-align: center;
    font-weight: bold;
    border-bottom: none;
    border-radius: 20px;
}

h1 small {
    display: block;
    font-size: 0.8em;
    color: #ccc;
    margin-top: 5px;
    font-weight: normal;
}

h2 {
    color: #448;
    font-size: 1.8em;
    margin-top: 30px;
    margin-bottom: 10px;
    border-bottom: 2px solid #bbf;
    padding-bottom: 5px;
}

h3 {
    color: #2020f0;
    font-size: 1.5em;
    margin-top: 10px;
    font-weight: bold;
}

h4 {
    color: #333;
    font-size: 1.1em;
}

pre {
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
    background-color: #101030;
    color: #d0d0d0;
    padding: 2px 4px;
    font-size: 0.9em;
    margin: 10px;
    padding: 10px;
}

#table-of-contents {
    background-color: #e0e0ff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    margin: 30px 0;
    border: 1px solid #e9ecef;
}

#contents-header {
    color: #d66767;
    margin-top: 0;
    text-align: center;
    border-bottom: 1px solid #dee2e6;
    padding-bottom: 10px;
    margin-bottom: 15px;
}

.toc ul {
    list-style: none;
    padding-left: 10px;
}

.toc li {
    list-style: none;
    padding-left: 10px;
}

.toc a {
    display: block;
    transition: color 0.2s ease;
    text-decoration: none;
}

.toc a:hover {
    color: #f78e25;
    background-color: #e4f8f7;
    text-decoration: none;
}

.example {
    margin: 20px 0;
    padding: 0;
}

.example h4 {
    margin-top: 15px;
    margin-bottom: 10px;
}

/* Estilos para títolos de sección similares a la imagen */
.section-title {
    background-color: #333;
    color: #f78e25;
    /* Naranja como en la imagen */
    padding: 10px 15px;
    font-size: 1.3em;
    margin: 30px 0 20px 0;
    text-align: center;
}

.section-subtitle {
    font-size: 1.1em;
    color: #333;
    margin-top: 20px;
    font-weight: bold;
}

/* Párrafos explicativos */
.explanation {
    margin-bottom: 15px;
}

/* Estilos para el glosario */
dl {
    margin: 20px 0;
}

dt {
    font-weight: bold;
    margin-top: 15px;
}

dd {
    margin-left: 20px;
    margin-bottom: 10px;
}
    </style>
</head>
<body>
<h1 id="sequelize-orm-para-bases-de-datos-relacionales">Sequelize: ORM para bases de datos relacionales</h1>

<div id="table-of-contents" class="toc">
  <h2 id="contents-header">Tabla de contenidos</h2>
<ul class="toc">
  <li class="toc"><a class="toc" href="#introduccion-a-orm">Introducción a ORM</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#ventajas-de-usar-un-orm">Ventajas de usar un ORM:</a></li>
    <li class="toc"><a class="toc" href="#desventajas">Desventajas:</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#sequelize-orm-para-nodejs">Sequelize: ORM para Node.js</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#instalacion">Instalación</a></li>
    <li class="toc"><a class="toc" href="#conexion-a-bases-de-datos-especificas">Conexión a Bases de Datos Específicas</a></li>
    <li class="toc"><a class="toc" href="#conexion-a-mysql">Conexión a MySQL</a></li>
    <li class="toc"><a class="toc" href="#conexion-a-sqlite">Conexión a SQLite</a></li>
    <li class="toc"><a class="toc" href="#practicas-recomendadas-para-conexiones-a-bases-de-datos">Prácticas Recomendadas para Conexiones a Bases de Datos</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#definicion-de-modelos">Definición de Modelos</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#tipos-de-datos-comunes">Tipos de Datos Comunes</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#sincronizacion-con-la-base-de-datos">Sincronización con la Base de Datos</a></li>
  <li class="toc"><a class="toc" href="#relaciones-entre-modelos">Relaciones entre Modelos</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#one-to-one-uno-a-uno">One-To-One (Uno a Uno)</a></li>
    <li class="toc"><a class="toc" href="#one-to-many-uno-a-muchos">One-To-Many (Uno a Muchos)</a></li>
    <li class="toc"><a class="toc" href="#many-to-many-muchos-a-muchos">Many-To-Many (Muchos a Muchos)</a></li>
    <li class="toc"><a class="toc" href="#opciones-avanzadas-para-relaciones">Opciones Avanzadas para Relaciones</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#operaciones-crud">Operaciones CRUD</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#create-crear">Create (Crear)</a></li>
    <li class="toc"><a class="toc" href="#read-leer">Read (Leer)</a></li>
    <li class="toc"><a class="toc" href="#update-actualizar">Update (Actualizar)</a></li>
    <li class="toc"><a class="toc" href="#delete-eliminar">Delete (Eliminar)</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#consultas-avanzadas">Consultas Avanzadas</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#operadores-comunes">Operadores Comunes</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#transacciones">Transacciones</a></li>
  <li class="toc"><a class="toc" href="#hooks-ganchos">Hooks (Ganchos)</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#implementacion-de-hooks">Implementación de Hooks</a></li>
    <li class="toc"><a class="toc" href="#casos-de-uso-comunes-para-hooks">Casos de uso comunes para hooks</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#migraciones">Migraciones</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#estructura-de-un-archivo-de-migracion">Estructura de un Archivo de Migración</a></li>
    <li class="toc"><a class="toc" href="#ejecutar-migraciones">Ejecutar Migraciones</a></li>
    <li class="toc"><a class="toc" href="#operaciones-comunes-en-migraciones">Operaciones Comunes en Migraciones</a></li>
    <li class="toc"><a class="toc" href="#semillas-seeds">Semillas (Seeds)</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#arquitectura-de-una-aplicacion-con-sequelize">Arquitectura de una Aplicación con Sequelize</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#estructura-de-carpetas-recomendada">Estructura de Carpetas Recomendada</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#generacion-de-codigo-con-sequelize-cli">Generación de Código con Sequelize CLI</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#instalacion-de-sequelize-cli">Instalación de Sequelize CLI</a></li>
    <li class="toc"><a class="toc" href="#generacion-de-modelos-y-migraciones">Generación de Modelos y Migraciones</a></li>
    <li class="toc"><a class="toc" href="#generacion-de-seeders">Generación de Seeders</a></li>
    <li class="toc"><a class="toc" href="#estructura-del-archivo-generado">Estructura del Archivo Generado</a></li>
    <li class="toc"><a class="toc" href="#completando-el-seeder">Completando el Seeder</a></li>
    <li class="toc"><a class="toc" href="#configuracion-en-packagejson">Configuración en package.json</a></li>
    <li class="toc"><a class="toc" href="#herramientas-de-terceros">Herramientas de Terceros</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#flujo-de-datos">Flujo de Datos</a></li>
  <li class="toc"><a class="toc" href="#patrones-de-diseno-comunes">Patrones de Diseño Comunes</a></li>
  <li class="toc"><a class="toc" href="#buenas-practicas">Buenas Prácticas</a></li>
  <li class="toc"><a class="toc" href="#implementacion-en-una-aplicacion-express">Implementación en una Aplicación Express</a>
  <ul class="toc">
    <li class="toc"><a class="toc" href="#configuracion-de-la-base-de-datos-configdatabasejs">Configuración de la Base de Datos (config/database.js)</a></li>
    <li class="toc"><a class="toc" href="#modelo-de-cliente-modelsclientjs">Modelo de Cliente (models/client.js)</a></li>
    <li class="toc"><a class="toc" href="#indice-de-modelos-modelsindexjs">Índice de Modelos (models/index.js)</a></li>
    <li class="toc"><a class="toc" href="#controlador-de-clientes-controllersclientcontrollerjs">Controlador de Clientes (controllers/clientController.js)</a></li>
    <li class="toc"><a class="toc" href="#rutas-para-clientes-routesclientroutesjs">Rutas para Clientes (routes/clientRoutes.js)</a></li>
    <li class="toc"><a class="toc" href="#aplicacion-express-appjs">Aplicación Express (app.js)</a></li>
  </ul>
  </li>
  <li class="toc"><a class="toc" href="#conclusion">Conclusión</a></li>
  <li class="toc"><a class="toc" href="#recursos-adicionales">Recursos Adicionales</a></li>
</ul>
</div>


<h2 id="introduccion-a-orm">Introducción a ORM</h2>
<p>Un <strong>ORM (Object-Relational Mapping)</strong> es una técnica de programación que permite convertir datos entre sistemas de tipos incompatibles en lenguajes de programación orientados a objetos. En términos simples, un ORM permite a los desarrolladores trabajar con bases de datos relacionales utilizando objetos de programación, eliminando la necesidad de escribir consultas SQL directamente.</p>
<p><a href="https://sequelize.org/docs/v6/">Documentación oficial de Sequelize versión 6</a></p>
<h3 id="ventajas-de-usar-un-orm">Ventajas de usar un ORM:</h3>
<ul>
<li><strong>Abstracción de la base de datos</strong>: Permite cambiar el motor de base de datos con cambios mínimos en el código.</li>
<li><strong>Seguridad</strong>: Ayuda a prevenir ataques de inyección SQL.</li>
<li><strong>Productividad</strong>: Reduce el código repetitivo y acelera el desarrollo.</li>
<li><strong>Mantenibilidad</strong>: El código es más limpio y fácil de mantener.</li>
<li><strong>Mapeo de objetos</strong>: Conversión automática entre tipos de datos de la base de datos y del lenguaje de programación.</li>
</ul>
<h3 id="desventajas">Desventajas:</h3>
<ul>
<li><strong>Rendimiento</strong>: Puede ser menos eficiente que SQL optimizado manualmente.</li>
<li><strong>Curva de aprendizaje</strong>: Requiere tiempo para dominar el ORM específico.</li>
<li><strong>Complejidad</strong>: Algunas consultas complejas pueden ser difíciles de expresar a través del ORM.</li>
</ul>
<h2 id="sequelize-orm-para-nodejs">Sequelize: ORM para Node.js</h2>
<p><strong>Sequelize</strong> es un ORM basado en promesas para Node.js que soporta PostgreSQL, MySQL, SQLite y MSSQL. Proporciona una abstracción sólida de la base de datos y facilita tareas comunes como la migración de esquemas y la validación de datos.</p>
<h3 id="instalacion">Instalación</h3>
<div class="highlight language-bash"><pre><span></span><span class="c1"># Instalación básica</span>
npm install sequelize

<span class="c1"># Instalar el driver para la base de datos</span>
npm install pg pg-hstore <span class="c1"># PostgreSQL</span>
npm install mysql2       <span class="c1"># MySQL</span>
npm install sqlite3      <span class="c1"># SQLite</span>
npm install tedious      <span class="c1"># Microsoft SQL Server</span>
</pre></div>

<h3 id="conexion-a-bases-de-datos-especificas">Conexión a Bases de Datos Específicas</h3>
<h3 id="conexion-a-mysql">Conexión a MySQL</h3>
<p>MySQL es uno de los sistemas de gestión de bases de datos relacionales más populares. Para conectarse a una base de datos MySQL con Sequelize, debes seguir estos pasos:</p>
<ol>
<li><strong>Instalar los paquetes necesarios</strong>:</li>
</ol>
<div class="highlight language-bash"><pre><span></span>npm install sequelize mysql2
</pre></div>

<ol start="2">
<li><strong>Configurar la conexión</strong>:</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-2')">Expandir</button>
    </div>
    <div id="code-block-2" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="p">{</span> <span class="nx">Sequelize</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>

<span class="c1">// Opción 1: Parámetros separados</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="s1">&#39;nombre_db&#39;</span><span class="p">,</span> <span class="s1">&#39;usuario&#39;</span><span class="p">,</span> <span class="s1">&#39;contraseña&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
  <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
  <span class="nx">port</span><span class="o">:</span> <span class="mf">3306</span><span class="p">,</span> <span class="c1">// Puerto por defecto de MySQL</span>
  <span class="nx">pool</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">max</span><span class="o">:</span> <span class="mf">5</span><span class="p">,</span>       <span class="c1">// Máximo número de conexiones en el pool</span>
    <span class="nx">min</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>       <span class="c1">// Mínimo número de conexiones en el pool</span>
    <span class="nx">acquire</span><span class="o">:</span> <span class="mf">30000</span><span class="p">,</span> <span class="c1">// Tiempo máximo (ms) para adquirir una conexión</span>
    <span class="nx">idle</span><span class="o">:</span> <span class="mf">10000</span>   <span class="c1">// Tiempo máximo (ms) que una conexión puede estar inactiva</span>
  <span class="p">},</span>
  <span class="nx">timezone</span><span class="o">:</span> <span class="s1">&#39;+00:00&#39;</span> <span class="c1">// Establecer zona horaria UTC (ajustar según necesidades)</span>
<span class="p">});</span>

<span class="c1">// Opción 2: URI de conexión</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="s1">&#39;mysql://usuario:contraseña@localhost:3306/nombre_db&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>

<ol start="3">
<li><strong>Verificar la conexión</strong>:</li>
</ol>
<div class="highlight language-javascript"><pre><span></span><span class="k">async</span> <span class="kd">function</span> <span class="nx">testMySQLConnection</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">authenticate</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Conexión a MySQL establecida correctamente.&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error al conectar con MySQL:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">testMySQLConnection</span><span class="p">();</span>
</pre></div>

<ol start="4">
<li><strong>Opciones específicas para MySQL</strong>:</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-4')">Expandir</button>
    </div>
    <div id="code-block-4" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="s1">&#39;nombre_db&#39;</span><span class="p">,</span> <span class="s1">&#39;usuario&#39;</span><span class="p">,</span> <span class="s1">&#39;contraseña&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
  <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
  <span class="nx">dialectOptions</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">charset</span><span class="o">:</span> <span class="s1">&#39;utf8mb4&#39;</span><span class="p">,</span> <span class="c1">// Soporte para caracteres especiales y emojis</span>
    <span class="nx">collate</span><span class="o">:</span> <span class="s1">&#39;utf8mb4_unicode_ci&#39;</span><span class="p">,</span>
    <span class="c1">// Para conexiones SSL:</span>
    <span class="nx">ssl</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">key</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;./client-key.pem&#39;</span><span class="p">),</span>
      <span class="nx">cert</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;./client-cert.pem&#39;</span><span class="p">),</span>
      <span class="nx">ca</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;./ca-cert.pem&#39;</span><span class="p">),</span>
      <span class="nx">rejectUnauthorized</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="c1">// Opciones para consultas</span>
    <span class="nx">multipleStatements</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// Permitir múltiples consultas en una sola sentencia</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
</div>

<h3 id="conexion-a-sqlite">Conexión a SQLite</h3>
<p>SQLite es una base de datos SQL contenida en un único archivo, lo que la hace ideal para desarrollo, pruebas o aplicaciones pequeñas. Para usar SQLite con Sequelize:</p>
<ol>
<li><strong>Instalar los paquetes necesarios</strong>:</li>
</ol>
<div class="highlight language-bash"><pre><span></span>npm install sequelize sqlite3
</pre></div>

<ol start="2">
<li><strong>Configurar la conexión</strong>:</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-6')">Expandir</button>
    </div>
    <div id="code-block-6" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="p">{</span> <span class="nx">Sequelize</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">);</span>

<span class="c1">// Opción 1: Conexión a un archivo SQLite</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">({</span>
  <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;sqlite&#39;</span><span class="p">,</span>
  <span class="nx">storage</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;database.sqlite&#39;</span><span class="p">),</span> <span class="c1">// Ruta al archivo</span>
  <span class="nx">logging</span><span class="o">:</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">,</span> <span class="c1">// Opcional: para ver las consultas SQL</span>
<span class="p">});</span>

<span class="c1">// Opción 2: SQLite en memoria (útil para pruebas)</span>
<span class="kd">const</span> <span class="nx">sequelizeMemory</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="s1">&#39;sqlite::memory:&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>

<ol start="3">
<li><strong>Verificar la conexión</strong>:</li>
</ol>
<div class="highlight language-javascript"><pre><span></span><span class="k">async</span> <span class="kd">function</span> <span class="nx">testSQLiteConnection</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">authenticate</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Conexión a SQLite establecida correctamente.&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error al conectar con SQLite:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">testSQLiteConnection</span><span class="p">();</span>
</pre></div>

<ol start="4">
<li><strong>Opciones adicionales para SQLite</strong>:</li>
</ol>
<div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">({</span>
  <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;sqlite&#39;</span><span class="p">,</span>
  <span class="nx">storage</span><span class="o">:</span> <span class="s1">&#39;./database.sqlite&#39;</span><span class="p">,</span>
  <span class="nx">dialectOptions</span><span class="o">:</span> <span class="p">{</span>
    <span class="c1">// Opciones específicas para SQLite</span>
    <span class="nx">mode</span><span class="o">:</span> <span class="nx">sqlite3</span><span class="p">.</span><span class="nx">OPEN_READWRITE</span> <span class="o">|</span> <span class="nx">sqlite3</span><span class="p">.</span><span class="nx">OPEN_CREATE</span><span class="p">,</span> <span class="c1">// Modo de apertura</span>
    <span class="nx">timeout</span><span class="o">:</span> <span class="mf">30000</span><span class="p">,</span> <span class="c1">// Tiempo de espera en ms para operaciones ocupadas</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<h3 id="practicas-recomendadas-para-conexiones-a-bases-de-datos">Prácticas Recomendadas para Conexiones a Bases de Datos</h3>
<ol>
<li><strong>Variables de entorno</strong>: Almacena las credenciales de conexión en variables de entorno y no en el código.</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-9')">Expandir</button>
    </div>
    <div id="code-block-9" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Usando dotenv para cargar variables de entorno desde un archivo .env</span>
<span class="nx">require</span><span class="p">(</span><span class="s1">&#39;dotenv&#39;</span><span class="p">).</span><span class="nx">config</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_NAME</span><span class="p">,</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_USER</span><span class="p">,</span>
  <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_PASSWORD</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nx">host</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_HOST</span><span class="p">,</span>
    <span class="nx">dialect</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_DIALECT</span> <span class="c1">// &#39;mysql&#39; o &#39;sqlite&#39;</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>

<ol start="2">
<li><strong>Conexiones por entorno</strong>: Configura conexiones diferentes según el entorno (desarrollo, pruebas, producción).</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-10')">Expandir</button>
    </div>
    <div id="code-block-10" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="nx">env</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">||</span> <span class="s1">&#39;development&#39;</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">development</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;sqlite&#39;</span><span class="p">,</span>
    <span class="nx">storage</span><span class="o">:</span> <span class="s1">&#39;./dev-database.sqlite&#39;</span>
  <span class="p">},</span>
  <span class="nx">test</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;sqlite&#39;</span><span class="p">,</span>
    <span class="nx">storage</span><span class="o">:</span> <span class="s1">&#39;:memory:&#39;</span>
  <span class="p">},</span>
  <span class="nx">production</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
    <span class="nx">host</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_HOST</span><span class="p">,</span>
    <span class="nx">username</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_USER</span><span class="p">,</span>
    <span class="nx">password</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_PASSWORD</span><span class="p">,</span>
    <span class="nx">database</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_NAME</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="nx">config</span><span class="p">[</span><span class="nx">env</span><span class="p">]);</span>
</pre></div>
</div>
</div>

<ol start="3">
<li><strong>Manejo del pool de conexiones</strong>: Ajusta el pool de conexiones según las necesidades de tu aplicación.</li>
</ol>
<div class="highlight language-javascript"><pre><span></span><span class="c1">// Para aplicaciones con alta carga (solo relevante para MySQL, no para SQLite)</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="s1">&#39;nombre_db&#39;</span><span class="p">,</span> <span class="s1">&#39;usuario&#39;</span><span class="p">,</span> <span class="s1">&#39;contraseña&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
  <span class="nx">pool</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">max</span><span class="o">:</span> <span class="mf">20</span><span class="p">,</span> <span class="c1">// Más conexiones para aplicaciones con mucho tráfico</span>
    <span class="nx">min</span><span class="o">:</span> <span class="mf">5</span><span class="p">,</span>  <span class="c1">// Mantener al menos 5 conexiones abiertas</span>
    <span class="nx">acquire</span><span class="o">:</span> <span class="mf">60000</span><span class="p">,</span> <span class="c1">// Tiempo más largo para adquirir conexión</span>
    <span class="nx">idle</span><span class="o">:</span> <span class="mf">30000</span> <span class="c1">// Más tiempo antes de cerrar conexiones inactivas</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<ol start="4">
<li><strong>Registro (logging)</strong>: Configura el nivel de registro según tus necesidades.</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-12')">Expandir</button>
    </div>
    <div id="code-block-12" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Registrar todas las consultas (desarrollo)</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
  <span class="nx">logging</span><span class="o">:</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="c1">// o logging: true</span>
<span class="p">});</span>

<span class="c1">// Registrar consultas lentas (producción)</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
  <span class="nx">logging</span><span class="o">:</span> <span class="p">(</span><span class="nx">sql</span><span class="p">,</span> <span class="nx">timing</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">timing</span> <span class="o">&amp;&amp;</span> <span class="nx">timing</span> <span class="o">&gt;</span> <span class="mf">1000</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Solo registrar consultas que tomen más de 1 segundo</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="sb">`Consulta lenta (</span><span class="si">${</span><span class="nx">timing</span><span class="si">}</span><span class="sb">ms):`</span><span class="p">,</span> <span class="nx">sql</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">benchmark</span><span class="o">:</span> <span class="kc">true</span> <span class="c1">// Habilitar medición de tiempo</span>
<span class="p">});</span>

<span class="c1">// Desactivar registro (producción)</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
  <span class="nx">logging</span><span class="o">:</span> <span class="kc">false</span>
<span class="p">});</span>
</pre></div>
</div>
</div>

<p>Estas configuraciones te permitirán conectarte eficientemente a bases de datos MySQL y SQLite con Sequelize, ajustando los parámetros según tus necesidades específicas.</p>
<h2 id="definicion-de-modelos">Definición de Modelos</h2>
<p>Los modelos en Sequelize representan tablas en la base de datos. </p>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-13')">Expandir</button>
    </div>
    <div id="code-block-13" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="p">{</span> <span class="nx">Sequelize</span><span class="p">,</span> <span class="nx">DataTypes</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">);</span>

<span class="c1">// Definición de un modelo User</span>
<span class="kd">const</span> <span class="nx">User</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="c1">// Definición de atributos</span>
  <span class="nx">id</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">INTEGER</span><span class="p">,</span>
    <span class="nx">autoIncrement</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">primaryKey</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span>
  <span class="nx">firstName</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
    <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
  <span class="p">},</span>
  <span class="nx">lastName</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">STRING</span>
  <span class="p">},</span>
  <span class="nx">email</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
    <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">unique</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">validate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">isEmail</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">age</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">INTEGER</span><span class="p">,</span>
    <span class="nx">validate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">min</span><span class="o">:</span> <span class="mf">0</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">isActive</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">BOOLEAN</span><span class="p">,</span>
    <span class="nx">defaultValue</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="p">{</span>
  <span class="c1">// Opciones del modelo</span>
  <span class="nx">timestamps</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>      <span class="c1">// Añade createdAt y updatedAt</span>
  <span class="nx">tableName</span><span class="o">:</span> <span class="s1">&#39;usuarios&#39;</span><span class="p">,</span> <span class="c1">// Nombre personalizado para la tabla</span>
  <span class="nx">paranoid</span><span class="o">:</span> <span class="kc">true</span>         <span class="c1">// Soft delete (añade deletedAt)</span>
<span class="p">});</span>
</pre></div>
</div>
</div>

<h3 id="tipos-de-datos-comunes">Tipos de Datos Comunes</h3>
<p>Sequelize proporciona varios tipos de datos que corresponden a los tipos de datos de las bases de datos:</p>
<ul>
<li><code>DataTypes.STRING</code>: VARCHAR(255)</li>
<li><code>DataTypes.TEXT</code>: TEXT</li>
<li><code>DataTypes.INTEGER</code>: INTEGER</li>
<li><code>DataTypes.FLOAT</code>: FLOAT</li>
<li><code>DataTypes.BOOLEAN</code>: BOOLEAN/TINYINT</li>
<li><code>DataTypes.DATE</code>: DATETIME</li>
<li><code>DataTypes.DATEONLY</code>: DATE</li>
<li><code>DataTypes.UUID</code>: UUID</li>
<li><code>DataTypes.JSON</code>: JSON (PostgreSQL, MySQL)</li>
<li><code>DataTypes.ARRAY</code>: ARRAY (PostgreSQL)</li>
</ul>
<h2 id="sincronizacion-con-la-base-de-datos">Sincronización con la Base de Datos</h2>
<p>Una vez definidos los modelos, es necesario sincronizarlos con la base de datos:</p>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-14')">Expandir</button>
    </div>
    <div id="code-block-14" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Sincronizar todos los modelos</span>
<span class="c1">// force: true -&gt; Elimina y recrea las tablas (¡cuidado en producción!)</span>
<span class="nx">sequelize</span><span class="p">.</span><span class="nx">sync</span><span class="p">({</span> <span class="nx">force</span><span class="o">:</span> <span class="kc">false</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Modelos sincronizados con la base de datos&#39;</span><span class="p">);</span>
  <span class="p">});</span>

<span class="c1">// Sincronizar un modelo específico</span>
<span class="nx">User</span><span class="p">.</span><span class="nx">sync</span><span class="p">({</span> <span class="nx">alter</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})</span> <span class="c1">// alter: true -&gt; Actualiza la tabla si existe</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Modelo User sincronizado&#39;</span><span class="p">);</span>
  <span class="p">});</span>
</pre></div>
</div>
</div>

<h2 id="relaciones-entre-modelos">Relaciones entre Modelos</h2>
<p>Sequelize soporta los tipos estándar de asociaciones. Estas relaciones son fundamentales para modelar correctamente la estructura de datos.</p>
<p><img alt="Diagrama entidad-relación de una aplicación compleja" src="E-r_Diagram.jpg" /></p>
<h3 id="one-to-one-uno-a-uno">One-To-One (Uno a Uno)</h3>
<p>Una relación uno a uno significa que un registro en la tabla A tiene exactamente un registro correspondiente en la tabla B.</p>
<div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="nx">User</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">});</span>
<span class="kd">const</span> <span class="nx">Profile</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;Profile&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">});</span>

<span class="c1">// Un usuario tiene un perfil</span>
<span class="nx">User</span><span class="p">.</span><span class="nx">hasOne</span><span class="p">(</span><span class="nx">Profile</span><span class="p">);</span>
<span class="c1">// Un perfil pertenece a un usuario</span>
<span class="nx">Profile</span><span class="p">.</span><span class="nx">belongsTo</span><span class="p">(</span><span class="nx">User</span><span class="p">);</span>
</pre></div>

<p>En la base de datos, esto típicamente se implementa añadiendo una clave foránea <code>UserId</code> en la tabla <code>Profiles</code>.</p>
<p><a href="https://siddharth-lakhara.medium.com/understanding-sequelize-associations-part-1-one-to-one-1-1-mapping-897ce176caf9">Más sobre relaciones de uno-a-uno</a></p>
<h3 id="one-to-many-uno-a-muchos">One-To-Many (Uno a Muchos)</h3>
<p>Una relación uno a muchos significa que un registro en la tabla A puede tener múltiples registros correspondientes en la tabla B.</p>
<div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="nx">User</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">});</span>
<span class="kd">const</span> <span class="nx">Post</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;Post&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">});</span>

<span class="c1">// Un usuario tiene muchos posts</span>
<span class="nx">User</span><span class="p">.</span><span class="nx">hasMany</span><span class="p">(</span><span class="nx">Post</span><span class="p">);</span>
<span class="c1">// Un post pertenece a un usuario</span>
<span class="nx">Post</span><span class="p">.</span><span class="nx">belongsTo</span><span class="p">(</span><span class="nx">User</span><span class="p">);</span>
</pre></div>

<p>En la base de datos, esto se implementa añadiendo una clave foránea <code>UserId</code> en la tabla <code>Posts</code>.</p>
<p><a href="https://siddharth-lakhara.medium.com/understanding-sequelize-associations-part-2-one-to-many-1-n-mapping-10a7d7929a5b">Más sobre relaciones de uno-a-muchos</a></p>
<h3 id="many-to-many-muchos-a-muchos">Many-To-Many (Muchos a Muchos)</h3>
<p>Una relación muchos a muchos significa que un registro en la tabla A puede tener múltiples registros correspondientes en la tabla B, y viceversa.</p>
<div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="nx">Student</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;Student&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">});</span>
<span class="kd">const</span> <span class="nx">Course</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;Course&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">});</span>

<span class="c1">// Un estudiante puede estar en muchos cursos</span>
<span class="nx">Student</span><span class="p">.</span><span class="nx">belongsToMany</span><span class="p">(</span><span class="nx">Course</span><span class="p">,</span> <span class="p">{</span> <span class="nx">through</span><span class="o">:</span> <span class="s1">&#39;StudentCourses&#39;</span> <span class="p">});</span>
<span class="c1">// Un curso puede tener muchos estudiantes</span>
<span class="nx">Course</span><span class="p">.</span><span class="nx">belongsToMany</span><span class="p">(</span><span class="nx">Student</span><span class="p">,</span> <span class="p">{</span> <span class="nx">through</span><span class="o">:</span> <span class="s1">&#39;StudentCourses&#39;</span> <span class="p">});</span>
</pre></div>

<p>En la base de datos, esto se implementa creando una tabla de unión (<code>StudentCourses</code>) que contiene claves foráneas para ambas tablas (<code>StudentId</code> y <code>CourseId</code>).</p>
<p><a href="https://siddharth-lakhara.medium.com/understanding-sequelize-associations-part-3-many-to-many-n-m-mapping-3e7dcdeb78db">Más sobre relaciones muchos-a-muchos</a></p>
<h3 id="opciones-avanzadas-para-relaciones">Opciones Avanzadas para Relaciones</h3>
<h4 id="personalizacion-de-claves-foraneas">Personalización de Claves Foráneas</h4>
<div class="highlight language-javascript"><pre><span></span><span class="nx">User</span><span class="p">.</span><span class="nx">hasMany</span><span class="p">(</span><span class="nx">Post</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">foreignKey</span><span class="o">:</span> <span class="s1">&#39;autorId&#39;</span><span class="p">,</span> <span class="c1">// Nombre personalizado para la clave foránea</span>
  <span class="kr">as</span><span class="o">:</span> <span class="s1">&#39;articulos&#39;</span>        <span class="c1">// Alias para la relación</span>
<span class="p">});</span>

<span class="nx">Post</span><span class="p">.</span><span class="nx">belongsTo</span><span class="p">(</span><span class="nx">User</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">foreignKey</span><span class="o">:</span> <span class="s1">&#39;autorId&#39;</span><span class="p">,</span>
  <span class="kr">as</span><span class="o">:</span> <span class="s1">&#39;autor&#39;</span>
<span class="p">});</span>
</pre></div>

<h4 id="relaciones-con-scope">Relaciones con Scope</h4>
<div class="highlight language-javascript"><pre><span></span><span class="c1">// Todos los comentarios donde approved = true</span>
<span class="nx">Post</span><span class="p">.</span><span class="nx">hasMany</span><span class="p">(</span><span class="nx">Comment</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">foreignKey</span><span class="o">:</span> <span class="s1">&#39;postId&#39;</span><span class="p">,</span>
  <span class="nx">scope</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">approved</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span>
  <span class="kr">as</span><span class="o">:</span> <span class="s1">&#39;approvedComments&#39;</span>
<span class="p">});</span>
</pre></div>

<h4 id="eliminacion-en-cascada">Eliminación en Cascada</h4>
<div class="highlight language-javascript"><pre><span></span><span class="nx">User</span><span class="p">.</span><span class="nx">hasMany</span><span class="p">(</span><span class="nx">Post</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">onDelete</span><span class="o">:</span> <span class="s1">&#39;CASCADE&#39;</span><span class="p">,</span>  <span class="c1">// Eliminar posts cuando se elimina el usuario</span>
  <span class="nx">onUpdate</span><span class="o">:</span> <span class="s1">&#39;CASCADE&#39;</span>   <span class="c1">// Actualizar posts cuando se actualiza el usuario</span>
<span class="p">});</span>
</pre></div>

<h2 id="operaciones-crud">Operaciones CRUD</h2>
<h3 id="create-crear">Create (Crear)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-21')">Expandir</button>
    </div>
    <div id="code-block-21" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Crear un registro</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">createUser</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">jane</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
      <span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Jane&#39;</span><span class="p">,</span>
      <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Doe&#39;</span><span class="p">,</span>
      <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;jane.doe@example.com&#39;</span><span class="p">,</span>
      <span class="nx">age</span><span class="o">:</span> <span class="mf">25</span>
    <span class="p">});</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Usuario creado:&#39;</span><span class="p">,</span> <span class="nx">jane</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">());</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error al crear usuario:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<h3 id="read-leer">Read (Leer)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-22')">Expandir</button>
    </div>
    <div id="code-block-22" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Encontrar todos los registros</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">findAllUsers</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">users</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findAll</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Todos los usuarios:&#39;</span><span class="p">,</span> <span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">users</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mf">2</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// Encontrar un registro por ID</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">findUserById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findByPk</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Usuario encontrado:&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">());</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Usuario no encontrado&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Encontrar registros con condiciones</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">findUsersByCondition</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">users</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findAll</span><span class="p">({</span>
    <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Doe&#39;</span><span class="p">,</span>
      <span class="nx">age</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">Op</span><span class="p">.</span><span class="nx">gte</span><span class="p">]</span><span class="o">:</span> <span class="mf">18</span> <span class="c1">// Operador mayor o igual que</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">attributes</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;firstName&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">],</span> <span class="c1">// Seleccionar solo ciertos campos</span>
    <span class="nx">order</span><span class="o">:</span> <span class="p">[[</span><span class="s1">&#39;createdAt&#39;</span><span class="p">,</span> <span class="s1">&#39;DESC&#39;</span><span class="p">]],</span> <span class="c1">// Ordenar por fecha de creación descendente</span>
    <span class="nx">limit</span><span class="o">:</span> <span class="mf">10</span><span class="p">,</span> <span class="c1">// Limitar a 10 resultados</span>
    <span class="nx">offset</span><span class="o">:</span> <span class="mf">0</span>  <span class="c1">// Comenzar desde el primer resultado</span>
  <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<h3 id="update-actualizar">Update (Actualizar)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-23')">Expandir</button>
    </div>
    <div id="code-block-23" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Actualizar un registro</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">updateUser</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">updatedRows</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Smith&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mf">26</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nx">where</span><span class="o">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">}</span> <span class="p">}</span>
  <span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">updatedRows</span><span class="si">}</span><span class="sb"> filas actualizadas`</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Actualizar o crear un registro</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">upsertUser</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">user</span><span class="p">,</span> <span class="nx">created</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">upsert</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">created</span> <span class="o">?</span> <span class="s1">&#39;Usuario creado&#39;</span> <span class="o">:</span> <span class="s1">&#39;Usuario actualizado&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<h3 id="delete-eliminar">Delete (Eliminar)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-24')">Expandir</button>
    </div>
    <div id="code-block-24" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Eliminar registros</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">deleteUser</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">deleted</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">destroy</span><span class="p">({</span>
    <span class="nx">where</span><span class="o">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">}</span>
  <span class="p">});</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">deleted</span><span class="si">}</span><span class="sb"> usuarios eliminados`</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Restaurar registros eliminados (con paranoid: true)</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">restoreUser</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">restore</span><span class="p">({</span>
    <span class="nx">where</span><span class="o">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<h2 id="consultas-avanzadas">Consultas Avanzadas</h2>
<p>Sequelize permite realizar consultas complejas con operadores y funciones:</p>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-25')">Expandir</button>
    </div>
    <div id="code-block-25" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="p">{</span> <span class="nx">Op</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>

<span class="c1">// Consulta con operadores</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">advancedQuery</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">users</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findAll</span><span class="p">({</span>
    <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
      <span class="p">[</span><span class="nx">Op</span><span class="p">.</span><span class="nx">or</span><span class="p">]</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="nx">age</span><span class="o">:</span> <span class="p">{</span> <span class="p">[</span><span class="nx">Op</span><span class="p">.</span><span class="nx">lt</span><span class="p">]</span><span class="o">:</span> <span class="mf">18</span> <span class="p">}</span> <span class="p">},</span> <span class="c1">// age &lt; 18</span>
        <span class="p">{</span> <span class="nx">age</span><span class="o">:</span> <span class="p">{</span> <span class="p">[</span><span class="nx">Op</span><span class="p">.</span><span class="nx">gt</span><span class="p">]</span><span class="o">:</span> <span class="mf">65</span> <span class="p">}</span> <span class="p">}</span>  <span class="c1">// age &gt; 65</span>
      <span class="p">],</span>
      <span class="p">[</span><span class="nx">Op</span><span class="p">.</span><span class="nx">and</span><span class="p">]</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="nx">isActive</span><span class="o">:</span> <span class="kc">true</span> <span class="p">},</span>
        <span class="p">{</span> <span class="nx">email</span><span class="o">:</span> <span class="p">{</span> <span class="p">[</span><span class="nx">Op</span><span class="p">.</span><span class="nx">like</span><span class="p">]</span><span class="o">:</span> <span class="s1">&#39;%@example.com&#39;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<h3 id="operadores-comunes">Operadores Comunes</h3>
<ul>
<li><code>Op.eq</code>: Igual a</li>
<li><code>Op.ne</code>: No igual a</li>
<li><code>Op.gt</code>: Mayor que</li>
<li><code>Op.gte</code>: Mayor o igual que</li>
<li><code>Op.lt</code>: Menor que</li>
<li><code>Op.lte</code>: Menor o igual que</li>
<li><code>Op.in</code>: En una lista</li>
<li><code>Op.notIn</code>: No en una lista</li>
<li><code>Op.like</code>: Como (con comodines)</li>
<li><code>Op.notLike</code>: No como</li>
<li><code>Op.between</code>: Entre dos valores</li>
<li><code>Op.notBetween</code>: No entre dos valores</li>
<li><code>Op.and</code>: Y lógico</li>
<li><code>Op.or</code>: O lógico</li>
<li><code>Op.not</code>: Negación lógica</li>
</ul>
<h2 id="transacciones">Transacciones</h2>
<p>Las transacciones garantizan que una serie de operaciones se completen con éxito o se reviertan todas:</p>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-26')">Expandir</button>
    </div>
    <div id="code-block-26" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="k">async</span> <span class="kd">function</span> <span class="nx">transferMoney</span><span class="p">(</span><span class="nx">fromAccountId</span><span class="p">,</span> <span class="nx">toAccountId</span><span class="p">,</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Iniciar transacción</span>
  <span class="kd">const</span> <span class="nx">t</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">transaction</span><span class="p">();</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// Realizar operaciones dentro de la transacción</span>
    <span class="k">await</span> <span class="nx">Account</span><span class="p">.</span><span class="nx">decrement</span><span class="p">(</span><span class="s1">&#39;balance&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">by</span><span class="o">:</span> <span class="nx">amount</span><span class="p">,</span>
      <span class="nx">where</span><span class="o">:</span> <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="nx">fromAccountId</span> <span class="p">},</span>
      <span class="nx">transaction</span><span class="o">:</span> <span class="nx">t</span>
    <span class="p">});</span>

    <span class="k">await</span> <span class="nx">Account</span><span class="p">.</span><span class="nx">increment</span><span class="p">(</span><span class="s1">&#39;balance&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">by</span><span class="o">:</span> <span class="nx">amount</span><span class="p">,</span>
      <span class="nx">where</span><span class="o">:</span> <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="nx">toAccountId</span> <span class="p">},</span>
      <span class="nx">transaction</span><span class="o">:</span> <span class="nx">t</span>
    <span class="p">});</span>

    <span class="c1">// Confirmar transacción</span>
    <span class="k">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">commit</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Transferencia completada con éxito&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Revertir transacción en caso de error</span>
    <span class="k">await</span> <span class="nx">t</span><span class="p">.</span><span class="nx">rollback</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error en la transferencia:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<h2 id="hooks-ganchos">Hooks (Ganchos)</h2>
<p>Los hooks permiten ejecutar funciones en determinados momentos del ciclo de vida de los modelos:</p>
<p><img alt="Ciclo de vida de los hooks de Sequalize" src="lifecicle.png" /></p>
<p>En el diagrama anterior se muestra el flujo de ejecución de los hooks durante el ciclo de vida de un modelo. Cada operación (create, update, delete) pasa por una serie de hooks que se ejecutan en un orden específico.</p>
<h3 id="implementacion-de-hooks">Implementación de Hooks</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-27')">Expandir</button>
    </div>
    <div id="code-block-27" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="kd">const</span> <span class="nx">User</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="c1">// ...atributos</span>
<span class="p">},</span> <span class="p">{</span>
  <span class="nx">hooks</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">beforeCreate</span><span class="o">:</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="c1">// Hash de contraseña antes de crear</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">user</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">hashSync</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span> <span class="mf">10</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">afterCreate</span><span class="o">:</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Nuevo usuario creado: </span><span class="si">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">firstName</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">beforeUpdate</span><span class="o">:</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="c1">// Lógica antes de actualizar</span>
    <span class="p">},</span>
    <span class="nx">afterDestroy</span><span class="o">:</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="c1">// Lógica después de eliminar</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<h3 id="casos-de-uso-comunes-para-hooks">Casos de uso comunes para hooks</h3>
<ol>
<li><strong>Encriptación de contraseñas</strong>: Encriptar contraseñas antes de guardarlas</li>
<li><strong>Normalización de datos</strong>: Formatear datos (por ejemplo, convertir emails a minúsculas)</li>
<li><strong>Generación de slugs</strong>: Crear slugs para URLs amigables</li>
<li><strong>Registro de cambios</strong>: Mantener un historial de cambios</li>
<li><strong>Notificaciones</strong>: Enviar notificaciones después de ciertas operaciones</li>
<li><strong>Validación compleja</strong>: Realizar validaciones que no se pueden expresar con los validadores estándar</li>
</ol>
<h2 id="migraciones">Migraciones</h2>
<p>Las migraciones permiten controlar los cambios en el esquema de la base de datos de manera ordenada y versionada.</p>
<h3 id="estructura-de-un-archivo-de-migracion">Estructura de un Archivo de Migración</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-28')">Expandir</button>
    </div>
    <div id="code-block-28" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">up</span><span class="o">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">queryInterface</span><span class="p">,</span> <span class="nx">Sequelize</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">createTable</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">id</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">autoIncrement</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">primaryKey</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">INTEGER</span>
      <span class="p">},</span>
      <span class="nx">firstName</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span>
      <span class="p">},</span>
      <span class="nx">lastName</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span>
      <span class="p">},</span>
      <span class="nx">email</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">unique</span><span class="o">:</span> <span class="kc">true</span>
      <span class="p">},</span>
      <span class="nx">createdAt</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">DATE</span>
      <span class="p">},</span>
      <span class="nx">updatedAt</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">DATE</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">},</span>

  <span class="nx">down</span><span class="o">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">queryInterface</span><span class="p">,</span> <span class="nx">Sequelize</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">dropTable</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div>

<h3 id="ejecutar-migraciones">Ejecutar Migraciones</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-29')">Expandir</button>
    </div>
    <div id="code-block-29" class="code-block-content collapsed"><div class="highlight language-bash"><pre><span></span><span class="c1"># Aplicar todas las migraciones pendientes</span>
npx sequelize-cli db:migrate

<span class="c1"># Revertir la última migración</span>
npx sequelize-cli db:migrate:undo

<span class="c1"># Revertir todas las migraciones</span>
npx sequelize-cli db:migrate:undo:all

<span class="c1"># Revertir hasta una migración específica</span>
npx sequelize-cli db:migrate:undo:all --to XXXXXXXXXXXXXX-create-users.js
</pre></div>
</div>
</div>

<h3 id="operaciones-comunes-en-migraciones">Operaciones Comunes en Migraciones</h3>
<ol>
<li><strong>Crear tabla</strong>:</li>
</ol>
<div class="highlight language-javascript"><pre><span></span><span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">createTable</span><span class="p">(</span><span class="s1">&#39;TableName&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="c1">// definición de columnas</span>
<span class="p">});</span>
</pre></div>

<ol start="2">
<li><strong>Modificar tabla</strong>:</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-31')">Expandir</button>
    </div>
    <div id="code-block-31" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Añadir columna</span>
<span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">addColumn</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="s1">&#39;phoneNumber&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span>
<span class="p">});</span>

<span class="c1">// Eliminar columna</span>
<span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">removeColumn</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="s1">&#39;phoneNumber&#39;</span><span class="p">);</span>

<span class="c1">// Cambiar tipo de columna</span>
<span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">changeColumn</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span><span class="p">(</span><span class="mf">100</span><span class="p">),</span>
  <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">unique</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>
</pre></div>
</div>
</div>

<ol start="3">
<li><strong>Añadir índices</strong>:</li>
</ol>
<div class="highlight language-javascript"><pre><span></span><span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">addIndex</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">]);</span>
</pre></div>

<ol start="4">
<li><strong>Crear restricciones</strong>:</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-33')">Expandir</button>
    </div>
    <div id="code-block-33" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// Añadir clave foránea</span>
<span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">addConstraint</span><span class="p">(</span><span class="s1">&#39;Posts&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">fields</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;userId&#39;</span><span class="p">],</span>
  <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;foreign key&#39;</span><span class="p">,</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;fk_posts_user&#39;</span><span class="p">,</span>
  <span class="nx">references</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">table</span><span class="o">:</span> <span class="s1">&#39;Users&#39;</span><span class="p">,</span>
    <span class="nx">field</span><span class="o">:</span> <span class="s1">&#39;id&#39;</span>
  <span class="p">},</span>
  <span class="nx">onDelete</span><span class="o">:</span> <span class="s1">&#39;cascade&#39;</span><span class="p">,</span>
  <span class="nx">onUpdate</span><span class="o">:</span> <span class="s1">&#39;cascade&#39;</span>
<span class="p">});</span>
</pre></div>
</div>
</div>

<h3 id="semillas-seeds">Semillas (Seeds)</h3>
<p>Las semillas permiten poblar la base de datos con datos iniciales o de prueba. Ejemplo de un archivo en la carpeta <code>seeders/</code>:</p>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-34')">Expandir</button>
    </div>
    <div id="code-block-34" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">up</span><span class="o">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">queryInterface</span><span class="p">,</span> <span class="nx">Sequelize</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">bulkInsert</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span>
        <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Doe&#39;</span><span class="p">,</span>
        <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;john@example.com&#39;</span><span class="p">,</span>
        <span class="nx">createdAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">(),</span>
        <span class="nx">updatedAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">()</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Jane&#39;</span><span class="p">,</span>
        <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Doe&#39;</span><span class="p">,</span>
        <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;jane@example.com&#39;</span><span class="p">,</span>
        <span class="nx">createdAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">(),</span>
        <span class="nx">updatedAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">()</span>
      <span class="p">}</span>
    <span class="p">]);</span>
  <span class="p">},</span>

  <span class="nx">down</span><span class="o">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">queryInterface</span><span class="p">,</span> <span class="nx">Sequelize</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">bulkDelete</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="p">{});</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div>

<p>Para ejecutar las semillas:</p>
<div class="highlight language-bash"><pre><span></span><span class="c1"># Ejecutar todas las semillas</span>
npx sequelize-cli db:seed:all

<span class="c1"># Revertir todas las semillas</span>
npx sequelize-cli db:seed:undo:all
</pre></div>

<h2 id="arquitectura-de-una-aplicacion-con-sequelize">Arquitectura de una Aplicación con Sequelize</h2>
<p>Una arquitectura bien diseñada es fundamental para construir aplicaciones escalables y mantenibles con Sequelize. A continuación se muestra cómo se estructura típicamente una aplicación con Sequelize siguiendo patrones MVC (Modelo-Vista-Controlador).</p>
<h3 id="estructura-de-carpetas-recomendada">Estructura de Carpetas Recomendada</h3>
<p>La siguiente estructura de carpetas es una forma organizada de implementar Sequelize en una aplicación Express:</p>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-36')">Expandir</button>
    </div>
    <div id="code-block-36" class="code-block-content collapsed"><div class="highlight language-text"><pre><span></span>proyecto/
├── config/                  # Configuraciones
│   ├── database.js          # Configuración de la base de datos
│   └── config.json          # Configuraciones por entorno
├── migrations/              # Migraciones de la base de datos
├── models/                  # Definición de modelos
│   ├── index.js             # Exporta todos los modelos
│   ├── user.js              # Modelo de Usuario
│   └── product.js           # Modelo de Producto
├── seeders/                 # Datos iniciales (semillas)
├── controllers/             # Controladores de la aplicación
│   ├── userController.js    # Controlador para usuarios
│   └── productController.js # Controlador para productos
├── routes/                  # Rutas de la API
│   ├── userRoutes.js        # Rutas para usuarios
│   └── productRoutes.js     # Rutas para productos
├── middlewares/             # Middlewares personalizados
├── services/                # Lógica de negocio
├── utils/                   # Utilidades
└── app.js                   # Punto de entrada
</pre></div>
</div>
</div>
<h2 id="generacion-de-codigo-con-sequelize-cli">Generación de Código con Sequelize CLI</h2>
<p>Sequelize ofrece herramientas para generar automáticamente código a través de su CLI. Esta funcionalidad puede mejorar significativamente la productividad del desarrollador.</p>
<h3 id="instalacion-de-sequelize-cli">Instalación de Sequelize CLI</h3>
<div class="highlight language-bash"><pre><span></span><span class="c1"># Instalación global</span>
npm install -g sequelize-cli

<span class="c1"># Instalación local (recomendada)</span>
npm install --save-dev sequelize-cli
</pre></div>

<h3 id="generacion-de-modelos-y-migraciones">Generación de Modelos y Migraciones</h3>
<p>Sequelize CLI permite generar un modelo junto con su migración correspondiente en un solo comando:</p>
<div class="highlight language-bash"><pre><span></span><span class="c1"># Generar modelo y migración</span>
npx sequelize-cli model:generate --name User --attributes firstName:string,lastName:string,email:string
</pre></div>

<p>Este comando creará:</p>
<ol>
<li>Un archivo de modelo en <code>models/user.js</code></li>
<li>Un archivo de migración en <code>migrations/XXXXXXXXXXXXXX-create-user.js</code></li>
</ol>
<p>La migración incluirá automáticamente los campos especificados en <code>--attributes</code>, además de <code>id</code>, <code>createdAt</code> y <code>updatedAt</code>.</p>
<h3 id="generacion-de-seeders">Generación de Seeders</h3>
<p>Sequelize CLI proporciona un comando simple para generar un nuevo archivo seeder:</p>
<div class="highlight language-bash"><pre><span></span><span class="c1"># Generar un seeder</span>
npx sequelize-cli seed:generate --name demo-users
</pre></div>

<p>Este comando crea un nuevo archivo JavaScript en la carpeta <code>seeders/</code> del proyecto. El nombre del archivo tendrá el formato:
<code>YYYYMMDDHHMMSS-demo-users.js</code> (donde YYYYMMDDHHMMSS es la fecha y hora de creación).</p>
<p>Por ejemplo: <code>20250514123456-demo-users.js</code></p>
<h3 id="estructura-del-archivo-generado">Estructura del Archivo Generado</h3>
<p>Al ejecutar el comando, Sequelize generará un archivo con esta estructura básica:</p>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-40')">Expandir</button>
    </div>
    <div id="code-block-40" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">up</span><span class="o">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">queryInterface</span><span class="p">,</span> <span class="nx">Sequelize</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Add seed commands here.</span>
<span class="cm">     *</span>
<span class="cm">     * Example:</span>
<span class="cm">     * await queryInterface.bulkInsert(&#39;People&#39;, [{</span>
<span class="cm">     *   name: &#39;John Doe&#39;,</span>
<span class="cm">     *   isBetaMember: false</span>
<span class="cm">     * }], {});</span>
<span class="cm">    */</span>
  <span class="p">},</span>

  <span class="nx">down</span><span class="o">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">queryInterface</span><span class="p">,</span> <span class="nx">Sequelize</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Add commands to revert seed here.</span>
<span class="cm">     *</span>
<span class="cm">     * Example:</span>
<span class="cm">     * await queryInterface.bulkDelete(&#39;People&#39;, null, {});</span>
<span class="cm">     */</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div>

<p>Este archivo contiene dos funciones principales:</p>
<ol>
<li><strong>up</strong>: Contiene el código para añadir datos a la base de datos.</li>
<li><strong>down</strong>: Contiene el código para revertir los cambios (eliminar los datos añadidos).</li>
</ol>
<h3 id="completando-el-seeder">Completando el Seeder</h3>
<p>Para que el seeder funcione, debes editar el archivo para incluir tus propios datos. Un ejemplo completo sería:</p>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-41')">Expandir</button>
    </div>
    <div id="code-block-41" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">up</span><span class="o">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">queryInterface</span><span class="p">,</span> <span class="nx">Sequelize</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">bulkInsert</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span>
        <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Doe&#39;</span><span class="p">,</span>
        <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;john@example.com&#39;</span><span class="p">,</span>
        <span class="nx">role</span><span class="o">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span>
        <span class="nx">createdAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">(),</span>
        <span class="nx">updatedAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">()</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Jane&#39;</span><span class="p">,</span>
        <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;Smith&#39;</span><span class="p">,</span>
        <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;jane@example.com&#39;</span><span class="p">,</span>
        <span class="nx">role</span><span class="o">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span>
        <span class="nx">createdAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">(),</span>
        <span class="nx">updatedAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">()</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">firstName</span><span class="o">:</span> <span class="s1">&#39;Admin&#39;</span><span class="p">,</span>
        <span class="nx">lastName</span><span class="o">:</span> <span class="s1">&#39;User&#39;</span><span class="p">,</span>
        <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;admin@example.com&#39;</span><span class="p">,</span>
        <span class="nx">role</span><span class="o">:</span> <span class="s1">&#39;admin&#39;</span><span class="p">,</span>
        <span class="nx">createdAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">(),</span>
        <span class="nx">updatedAt</span><span class="o">:</span> <span class="ow">new</span> <span class="nb">Date</span><span class="p">()</span>
      <span class="p">}</span>
    <span class="p">]);</span>
  <span class="p">},</span>

  <span class="nx">down</span><span class="o">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">queryInterface</span><span class="p">,</span> <span class="nx">Sequelize</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">queryInterface</span><span class="p">.</span><span class="nx">bulkDelete</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="p">{});</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div>

<h3 id="configuracion-en-packagejson">Configuración en package.json</h3>
<p>Para facilitar el uso, podemos añadir estos scripts a nuestro <code>package.json</code>:</p>
<div class="highlight language-json"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;scripts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;migrate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sequelize-cli db:migrate&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;migrate:undo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sequelize-cli db:migrate:undo&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;seed&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sequelize-cli db:seed:all&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;seed:undo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sequelize-cli db:seed:undo:all&quot;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>

<h3 id="herramientas-de-terceros">Herramientas de Terceros</h3>
<p>También existen paquetes de terceros que facilitan la generación de código con Sequelize:</p>
<ol>
<li>
<p><strong>sequelize-auto</strong>: Genera modelos a partir de una base de datos existente.
 <br />
<div class="highlight language-bash"><pre><span></span>   npm install -g sequelize-auto
   sequelize-auto -h localhost -d database -u username -p password -x port

</pre></div>
</p>
</li>
<li>
<p><strong>sequelize-mig</strong>: Genera migraciones a partir de cambios en los modelos.
 <br />
<div class="highlight language-bash"><pre><span></span>   npm install -g sequelize-mig
   sequelize-mig migration:make -n <span class="s2">&quot;create-users&quot;</span>

</pre></div>
</p>
</li>
</ol>
<p>Estas herramientas pueden ayudar a generar rápidamente código boilerplate y enfocarse en la lógica de negocio.</p>
<h2 id="flujo-de-datos">Flujo de Datos</h2>
<p>El siguiente diagrama ilustra el flujo de datos en una aplicación que utiliza Sequelize:</p>
<p><img alt="Flujo de datos en una aplicación con Sequelize" src="data_flow.png" /></p>
<h2 id="patrones-de-diseno-comunes">Patrones de Diseño Comunes</h2>
<ol>
<li><strong>Repositorio</strong>: Encapsula la lógica de acceso a datos</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-45')">Expandir</button>
    </div>
    <div id="code-block-45" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// repositories/userRepository.js</span>
<span class="kd">class</span> <span class="nx">UserRepository</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">findAll</span><span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">findById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findByPk</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">create</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">User</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Más métodos...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<ol start="2">
<li><strong>Servicio</strong>: Contiene la lógica de negocio</li>
</ol>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-46')">Expandir</button>
    </div>
    <div id="code-block-46" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// services/userService.js</span>
<span class="kd">class</span> <span class="nx">UserService</span> <span class="p">{</span>
  <span class="kr">constructor</span><span class="p">(</span><span class="nx">userRepository</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span> <span class="o">=</span> <span class="nx">userRepository</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">registerUser</span><span class="p">(</span><span class="nx">userData</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Validaciones, reglas de negocio...</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">userData</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Más métodos...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<h2 id="buenas-practicas">Buenas Prácticas</h2>
<ol>
<li><strong>Utiliza migraciones</strong>: Para mantener un control de versiones del esquema de la base de datos.</li>
<li><strong>Modulariza tus modelos</strong>: Cada modelo en su propio archivo.</li>
<li><strong>Valida datos</strong>: Aprovecha las validaciones de Sequelize.</li>
<li><strong>Usa transacciones</strong>: Para operaciones que afectan a múltiples registros.</li>
<li><strong>Maneja errores</strong>: Captura y maneja adecuadamente los errores.</li>
<li><strong>Evita consultas N+1</strong>: Utiliza eager loading (include) para cargar relaciones.</li>
<li><strong>Limita consultas</strong>: Utiliza limit, offset y scopes para consultas eficientes.</li>
<li><strong>Seguridad</strong>: Nunca confíes en la entrada del usuario sin validación.</li>
<li><strong>Testing</strong>: Prueba tus modelos y consultas.</li>
<li><strong>Documentación</strong>: Documenta tus modelos y sus relaciones.</li>
</ol>
<h2 id="implementacion-en-una-aplicacion-express">Implementación en una Aplicación Express</h2>
<p>A continuación, veremos cómo implementar Sequelize en una aplicación Express utilizando una estructura de carpetas organizada. Transformaremos el ejemplo del modelo <code>Client</code> en memoria a un modelo Sequelize para usar en una API REST.</p>
<h3 id="configuracion-de-la-base-de-datos-configdatabasejs">Configuración de la Base de Datos (config/database.js)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-47')">Expandir</button>
    </div>
    <div id="code-block-47" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// config/database.js</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">Sequelize</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">env</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">||</span> <span class="s1">&#39;development&#39;</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">development</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">database</span><span class="o">:</span> <span class="s1">&#39;db_development&#39;</span><span class="p">,</span>
    <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
    <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
    <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
    <span class="nx">logging</span><span class="o">:</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span>
  <span class="p">},</span>
  <span class="nx">test</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">database</span><span class="o">:</span> <span class="s1">&#39;db_test&#39;</span><span class="p">,</span>
    <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
    <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
    <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
    <span class="nx">logging</span><span class="o">:</span> <span class="kc">false</span>
  <span class="p">},</span>
  <span class="nx">production</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">database</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_NAME</span><span class="p">,</span>
    <span class="nx">username</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_USER</span><span class="p">,</span>
    <span class="nx">password</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_PASSWORD</span><span class="p">,</span>
    <span class="nx">host</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_HOST</span><span class="p">,</span>
    <span class="nx">dialect</span><span class="o">:</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
    <span class="nx">logging</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">pool</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">max</span><span class="o">:</span> <span class="mf">5</span><span class="p">,</span>
      <span class="nx">min</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
      <span class="nx">acquire</span><span class="o">:</span> <span class="mf">30000</span><span class="p">,</span>
      <span class="nx">idle</span><span class="o">:</span> <span class="mf">10000</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">Sequelize</span><span class="p">(</span>
  <span class="nx">config</span><span class="p">[</span><span class="nx">env</span><span class="p">].</span><span class="nx">database</span><span class="p">,</span>
  <span class="nx">config</span><span class="p">[</span><span class="nx">env</span><span class="p">].</span><span class="nx">username</span><span class="p">,</span>
  <span class="nx">config</span><span class="p">[</span><span class="nx">env</span><span class="p">].</span><span class="nx">password</span><span class="p">,</span>
  <span class="nx">config</span><span class="p">[</span><span class="nx">env</span><span class="p">]</span>
<span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">;</span>
</pre></div>
</div>
</div>

<h3 id="modelo-de-cliente-modelsclientjs">Modelo de Cliente (models/client.js)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-48')">Expandir</button>
    </div>
    <div id="code-block-48" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// models/client.js</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">DataTypes</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sequelize&#39;</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../config/database&#39;</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">Client</span> <span class="o">=</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;Client&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="c1">// Definimos los campos de la tabla</span>
  <span class="nx">id</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">INTEGER</span><span class="p">,</span>
    <span class="nx">primaryKey</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">autoIncrement</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span>
  <span class="nx">nombre</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
    <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">validate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">notEmpty</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;El nombre no puede estar vacío&#39;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">apellido</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
    <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">validate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">notEmpty</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;El apellido no puede estar vacío&#39;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">dni</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">DataTypes</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
    <span class="nx">allowNull</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">unique</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;El DNI ya está registrado&#39;</span>
    <span class="p">},</span>
    <span class="nx">validate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">notEmpty</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;El DNI no puede estar vacío&#39;</span>
      <span class="p">},</span>
      <span class="nx">isNumeric</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;El DNI debe contener solo números&#39;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="p">{</span>
  <span class="nx">tableName</span><span class="o">:</span> <span class="s1">&#39;clients&#39;</span><span class="p">,</span>
  <span class="nx">timestamps</span><span class="o">:</span> <span class="kc">true</span> <span class="c1">// Añade createdAt y updatedAt</span>
<span class="p">});</span>

<span class="c1">// Métodos estáticos personalizados (similar al mock original)</span>
<span class="nx">Client</span><span class="p">.</span><span class="nx">createClient</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nombre</span><span class="p">,</span> <span class="nx">apellido</span><span class="p">,</span> <span class="nx">dni</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span> <span class="nx">nombre</span><span class="p">,</span> <span class="nx">apellido</span><span class="p">,</span> <span class="nx">dni</span> <span class="p">});</span>
    <span class="k">return</span> <span class="nx">client</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Client</span><span class="p">.</span><span class="nx">updateClient</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">nombre</span><span class="p">,</span> <span class="nx">apellido</span><span class="p">,</span> <span class="nx">dni</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">findByPk</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">client</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="ow">new</span> <span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Error: el id no existe&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span> <span class="nx">nombre</span><span class="p">,</span> <span class="nx">apellido</span><span class="p">,</span> <span class="nx">dni</span> <span class="p">});</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Client</span><span class="p">.</span><span class="nx">deleteClient</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">findByPk</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">client</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="ow">new</span> <span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Error: el id no existe&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Client</span><span class="p">.</span><span class="nx">listClients</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">clients</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">findAll</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">clients</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">client</span> <span class="p">=&gt;</span> <span class="sb">`</span><span class="si">${</span><span class="nx">client</span><span class="p">.</span><span class="nx">apellido</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">client</span><span class="p">.</span><span class="nx">nombre</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Client</span><span class="p">;</span>
</pre></div>
</div>
</div>

<h3 id="indice-de-modelos-modelsindexjs">Índice de Modelos (models/index.js)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-49')">Expandir</button>
    </div>
    <div id="code-block-49" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// models/index.js</span>
<span class="kd">const</span> <span class="nx">sequelize</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../config/database&#39;</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">Client</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./client&#39;</span><span class="p">);</span>

<span class="c1">// Agregar otros modelos aquí...</span>
<span class="c1">// const OtroModelo = require(&#39;./otroModelo&#39;);</span>

<span class="c1">// Definir relaciones entre modelos</span>
<span class="c1">// Client.hasMany(OtroModelo);</span>
<span class="c1">// OtroModelo.belongsTo(Client);</span>

<span class="kd">const</span> <span class="nx">db</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">sequelize</span><span class="p">,</span>
  <span class="nx">Client</span>
  <span class="c1">// Agregar otros modelos aquí</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">db</span><span class="p">;</span>
</pre></div>
</div>
</div>

<h3 id="controlador-de-clientes-controllersclientcontrollerjs">Controlador de Clientes (controllers/clientController.js)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-50')">Expandir</button>
    </div>
    <div id="code-block-50" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// controllers/clientController.js</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">Client</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../models&#39;</span><span class="p">);</span>

<span class="c1">// Obtener todos los clientes</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">getAllClients</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">clients</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Client</span><span class="p">.</span><span class="nx">findAll</span><span class="p">();</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">json</span><span class="p">(</span><span class="nx">clients</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">500</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Obtener un cliente por ID</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">getClientById</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Client</span><span class="p">.</span><span class="nx">findByPk</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">client</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">404</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;Cliente no encontrado&#39;</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">json</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">500</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Crear un nuevo cliente</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">createClient</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">nombre</span><span class="p">,</span> <span class="nx">apellido</span><span class="p">,</span> <span class="nx">dni</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Client</span><span class="p">.</span><span class="nx">createClient</span><span class="p">(</span><span class="nx">nombre</span><span class="p">,</span> <span class="nx">apellido</span><span class="p">,</span> <span class="nx">dni</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">201</span><span class="p">).</span><span class="nx">json</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Actualizar un cliente</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">updateClient</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">nombre</span><span class="p">,</span> <span class="nx">apellido</span><span class="p">,</span> <span class="nx">dni</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Client</span><span class="p">.</span><span class="nx">updateClient</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">nombre</span><span class="p">,</span> <span class="nx">apellido</span><span class="p">,</span> <span class="nx">dni</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">json</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="o">===</span> <span class="s1">&#39;Error: el id no existe&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">404</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;Cliente no encontrado&#39;</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Eliminar un cliente</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">deleteClient</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">Client</span><span class="p">.</span><span class="nx">deleteClient</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">204</span><span class="p">).</span><span class="nx">send</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="o">===</span> <span class="s1">&#39;Error: el id no existe&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">404</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;Cliente no encontrado&#39;</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">500</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Obtener lista formateada de clientes</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">getClientList</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">clientList</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Client</span><span class="p">.</span><span class="nx">listClients</span><span class="p">();</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">json</span><span class="p">(</span><span class="nx">clientList</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">500</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span> <span class="nx">message</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div>

<h3 id="rutas-para-clientes-routesclientroutesjs">Rutas para Clientes (routes/clientRoutes.js)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-51')">Expandir</button>
    </div>
    <div id="code-block-51" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// routes/clientRoutes.js</span>
<span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Router</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">clientController</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../controllers/clientController&#39;</span><span class="p">);</span>

<span class="c1">// Definir rutas</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nx">clientController</span><span class="p">.</span><span class="nx">getAllClients</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/list&#39;</span><span class="p">,</span> <span class="nx">clientController</span><span class="p">.</span><span class="nx">getClientList</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/:id&#39;</span><span class="p">,</span> <span class="nx">clientController</span><span class="p">.</span><span class="nx">getClientById</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nx">clientController</span><span class="p">.</span><span class="nx">createClient</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;/:id&#39;</span><span class="p">,</span> <span class="nx">clientController</span><span class="p">.</span><span class="nx">updateClient</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="s1">&#39;/:id&#39;</span><span class="p">,</span> <span class="nx">clientController</span><span class="p">.</span><span class="nx">deleteClient</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">router</span><span class="p">;</span>
</pre></div>
</div>
</div>

<h3 id="aplicacion-express-appjs">Aplicación Express (app.js)</h3>
<div class="code-block-container">
    <div class="code-block-header">
        <button class="code-block-toggle" onclick="toggleCodeBlock('code-block-52')">Expandir</button>
    </div>
    <div id="code-block-52" class="code-block-content collapsed"><div class="highlight language-javascript"><pre><span></span><span class="c1">// app.js</span>
<span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">sequelize</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./models&#39;</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">clientRoutes</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./routes/clientRoutes&#39;</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mf">3000</span><span class="p">;</span>

<span class="c1">// Middleware</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>

<span class="c1">// Rutas</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;/api/clients&#39;</span><span class="p">,</span> <span class="nx">clientRoutes</span><span class="p">);</span>

<span class="c1">// Sincronizar modelos con la base de datos</span>
<span class="nx">sequelize</span><span class="p">.</span><span class="nx">sync</span><span class="p">({</span> <span class="nx">force</span><span class="o">:</span> <span class="kc">false</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Base de datos sincronizada&#39;</span><span class="p">);</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Servidor corriendo en el puerto </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error al sincronizar la base de datos:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>
</pre></div>
</div>
</div>

<p>Este ejemplo muestra cómo transformar el modelo <code>Client</code> en memoria a un modelo Sequelize para usar en una aplicación Express. Hemos mantenido la funcionalidad del mock original (create, update, delete, list) pero implementándolo con Sequelize.</p>
<p>Los métodos estáticos personalizados (<code>createClient</code>, <code>updateClient</code>, <code>deleteClient</code>, <code>listClients</code>) proporcionan una interfaz similar al mock original, pero ahora usando la base de datos relacional a través de Sequelize.</p>
<h2 id="conclusion">Conclusión</h2>
<p>Sequelize es una herramienta poderosa que simplifica la interacción con bases de datos relacionales en aplicaciones Node.js. Si bien tiene una curva de aprendizaje, las ventajas que ofrece en términos de productividad, mantenibilidad y seguridad hacen que valga la pena invertir tiempo en dominarla.</p>
<p>Como todo ORM, hay que ser consciente de sus limitaciones, especialmente en consultas muy complejas o con grandes volúmenes de datos donde el SQL nativo puede ser más eficiente. Sin embargo, para la mayoría de las aplicaciones, Sequelize proporciona un excelente equilibrio entre facilidad de uso y rendimiento.</p>
<h2 id="recursos-adicionales">Recursos Adicionales</h2>
<ul>
<li><a href="https://sequelize.org/master/">Documentación oficial de Sequelize</a></li>
<li><a href="https://github.com/sequelize/sequelize">Repositorio de GitHub</a></li>
<li><a href="https://sequelize.org/master/manual/migrations.html">Guía de migraciones</a></li>
<li><a href="https://sequelize.org/master/manual/validations-and-constraints.html">Validaciones en Sequelize</a></li>
<li><a href="https://sequelize.org/master/manual/hooks.html">Hooks (Callbacks)</a></li>
</ul>
<script>
    function toggleCodeBlock(blockId) {
        const codeBlock = document.getElementById(blockId);
        const button = codeBlock.parentElement.querySelector(".code-block-toggle");
        if (codeBlock.classList.contains("collapsed")) {
            codeBlock.classList.remove("collapsed");
            button.textContent = "Colapsar";
        } else {
            codeBlock.classList.add("collapsed");
            button.textContent = "Expandir";
        }
    }
    // Set the initial state of collapsible code blocks
    document.addEventListener("DOMContentLoaded", function() {
        // Find all code blocks and collapse them initially
        const codeBlocks = document.querySelectorAll(".code-block-content");
        codeBlocks.forEach(block => {
            // Set initial state to collapsed
            const button = block.parentElement.querySelector(".code-block-toggle");
            if (button) {
                block.classList.add("collapsed");
                button.textContent = "Expandir";
            }
        });
    });
</script>
</body>
</html>
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>crud</title>



</head>
<body style="font-family: Century Gothic, Arial, Helvetica, sans-serif; line-height: 1.5; max-width: none; margin: 0 auto; padding: 20px; color: #333">
<div style="background: #272822; color: #f8f8f2; padding: 1em; border-radius: 5px; margin: 1em 0"><pre style='line-height: 125%; background-color: #101030; padding: 10px; border-radius: 5px; overflow-x: auto; font-family: Consolas, Monaco, "Andale Mono", monospace; color: #d0d0d0; font-size: 0.9em; margin: 10px'><span></span><span style="color: #f92672">from</span> <span style="color: #f8f8f2">pymongo</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">MongoClient</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">datetime</span>
<span style="color: #f92672">from</span> <span style="color: #f8f8f2">bson.objectid</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">ObjectId</span>

<span style="color: #75715e"># Paso 1: Conectar a MongoDB</span>
<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">get_database</span><span style="color: #f8f8f2">():</span>
    <span style="color: #75715e"># Crear una conexión utilizando MongoClient</span>
    <span style="color: #f8f8f2">client</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">MongoClient</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">'mongodb://localhost:27017/'</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Obtener/crear una base de datos llamada 'empresa'</span>
    <span style="color: #f8f8f2">db</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">client</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'empresa'</span><span style="color: #f8f8f2">]</span>
    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">db</span>

<span style="color: #75715e"># ------------------ CREATE ------------------</span>
<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">crear_empleado</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleados_collection</span><span style="color: #f8f8f2">):</span>
    <span style="color: #75715e"># Definir un nuevo documento (registro)</span>
    <span style="color: #f8f8f2">nuevo_empleado</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #e6db74">"nombre"</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">"Ana García"</span><span style="color: #f8f8f2">,</span>
        <span style="color: #e6db74">"email"</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">"ana.garcia@ejemplo.com"</span><span style="color: #f8f8f2">,</span>
        <span style="color: #e6db74">"edad"</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">28</span><span style="color: #f8f8f2">,</span>
        <span style="color: #e6db74">"puesto"</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">"Desarrollador Python"</span><span style="color: #f8f8f2">,</span>
        <span style="color: #e6db74">"fecha_contratacion"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">datetime</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">datetime</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">now</span><span style="color: #f8f8f2">(),</span>
        <span style="color: #e6db74">"habilidades"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">"Python"</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">"MongoDB"</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">"Flask"</span><span style="color: #f8f8f2">]</span>
    <span style="color: #f8f8f2">}</span>

    <span style="color: #75715e"># Insertar el documento en la colección</span>
    <span style="color: #f8f8f2">resultado</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">insert_one</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">nuevo_empleado</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Devolver el ID del nuevo documento</span>
    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"Empleado creado con ID: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">resultado</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">inserted_id</span><span style="color: #e6db74">}</span><span style="color: #e6db74">"</span><span style="color: #f8f8f2">)</span>
    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">resultado</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">inserted_id</span>

<span style="color: #75715e"># ------------------ READ ------------------</span>
<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">leer_empleados</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleados_collection</span><span style="color: #f8f8f2">):</span>
    <span style="color: #75715e"># Obtener todos los empleados</span>
    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">"</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">Todos los empleados:"</span><span style="color: #f8f8f2">)</span>
    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">empleado</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">find</span><span style="color: #f8f8f2">():</span>
        <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"ID: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'_id'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">, Nombre: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'nombre'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">, Puesto: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'puesto'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">"</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Buscar un empleado específico por nombre</span>
    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">"</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">Buscar por nombre:"</span><span style="color: #f8f8f2">)</span>
    <span style="color: #f8f8f2">empleado</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">find_one</span><span style="color: #f8f8f2">({</span><span style="color: #e6db74">"nombre"</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">"Ana García"</span><span style="color: #f8f8f2">})</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">:</span>
        <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"Encontrado: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'nombre'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">, Email: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'email'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">"</span><span style="color: #f8f8f2">)</span>
    <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
        <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">"Empleado no encontrado"</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Buscar empleados por criterio (ejemplo: mayores de 25 años)</span>
    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">"</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">Empleados mayores de 25 años:"</span><span style="color: #f8f8f2">)</span>
    <span style="color: #f8f8f2">query</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span><span style="color: #e6db74">"edad"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">{</span><span style="color: #e6db74">"$gt"</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">25</span><span style="color: #f8f8f2">}}</span>
    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">empleado</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">find</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">query</span><span style="color: #f8f8f2">):</span>
        <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"Nombre: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'nombre'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">, Edad: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'edad'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">"</span><span style="color: #f8f8f2">)</span>

<span style="color: #75715e"># ------------------ UPDATE ------------------</span>
<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">actualizar_empleado</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleado_id</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f8f8f2">):</span>
    <span style="color: #75715e"># Actualizar un solo campo</span>
    <span style="color: #f8f8f2">filtro</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span><span style="color: #e6db74">"_id"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">ObjectId</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleado_id</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">)}</span>
    <span style="color: #f8f8f2">nueva_info</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span><span style="color: #e6db74">"$set"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">{</span><span style="color: #e6db74">"edad"</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">29</span><span style="color: #f8f8f2">}}</span>

    <span style="color: #f8f8f2">resultado</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">update_one</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">filtro</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">nueva_info</span><span style="color: #f8f8f2">)</span>
    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">Empleado actualizado: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">resultado</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">modified_count</span><span style="color: #e6db74">}</span><span style="color: #e6db74"> documento(s) modificado(s)"</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Actualizar múltiples campos</span>
    <span style="color: #f8f8f2">nueva_info_multiple</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #e6db74">"$set"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">{</span>
            <span style="color: #e6db74">"puesto"</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">"Desarrollador Senior Python"</span><span style="color: #f8f8f2">,</span>
            <span style="color: #e6db74">"habilidades"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">"Python"</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">"MongoDB"</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">"Flask"</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">"FastAPI"</span><span style="color: #f8f8f2">]</span>
        <span style="color: #f8f8f2">}</span>
    <span style="color: #f8f8f2">}</span>

    <span style="color: #f8f8f2">resultado</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">update_one</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">filtro</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">nueva_info_multiple</span><span style="color: #f8f8f2">)</span>
    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"Información actualizada: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">resultado</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">modified_count</span><span style="color: #e6db74">}</span><span style="color: #e6db74"> documento(s) modificado(s)"</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Verificar la actualización</span>
    <span style="color: #f8f8f2">empleado_actualizado</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">find_one</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">filtro</span><span style="color: #f8f8f2">)</span>
    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"Empleado actualizado: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado_actualizado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'nombre'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">, Puesto: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado_actualizado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'puesto'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">"</span><span style="color: #f8f8f2">)</span>

<span style="color: #75715e"># ------------------ DELETE ------------------</span>
<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">eliminar_empleado</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleado_id</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f8f8f2">):</span>
    <span style="color: #75715e"># Eliminar un solo documento</span>
    <span style="color: #f8f8f2">filtro</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span><span style="color: #e6db74">"_id"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">ObjectId</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleado_id</span><span style="color: #f8f8f2">)}</span>
    <span style="color: #f8f8f2">resultado</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">delete_one</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">filtro</span><span style="color: #f8f8f2">)</span>

    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">Empleado eliminado: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">resultado</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">deleted_count</span><span style="color: #e6db74">}</span><span style="color: #e6db74"> documento(s) eliminado(s)"</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Podríamos también eliminar múltiples documentos</span>
    <span style="color: #75715e"># Por ejemplo, eliminar todos los empleados con edad &gt; 60</span>
    <span style="color: #75715e"># resultado = empleados_collection.delete_many({"edad": {"$gt": 60}})</span>

<span style="color: #75715e"># ------------------ EJECUTAR OPERACIONES ------------------</span>
<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #75715e"># Obtener la base de datos</span>
    <span style="color: #f8f8f2">db</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">get_database</span><span style="color: #f8f8f2">()</span>

    <span style="color: #75715e"># Obtener una colección (equivalente a una tabla en BD relacionales)</span>
    <span style="color: #f8f8f2">empleados_collection</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">db</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'empleados'</span><span style="color: #f8f8f2">]</span>
    <span style="color: #75715e"># Crear un nuevo empleado y obtener su ID</span>
    <span style="color: #f8f8f2">empleado_id</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">crear_empleado</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleados_collection</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Leer empleados</span>
    <span style="color: #f8f8f2">leer_empleados</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleados_collection</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Actualizar el empleado recién creado</span>
    <span style="color: #f8f8f2">actualizar_empleado</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleado_id</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Eliminar el empleado</span>
    <span style="color: #f8f8f2">eliminar_empleado</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleado_id</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f8f8f2">)</span>

    <span style="color: #75715e"># Verificar que se haya eliminado</span>
    <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">"</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">Verificar después de eliminar:"</span><span style="color: #f8f8f2">)</span>
    <span style="color: #f8f8f2">empleado</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">empleados_collection</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">find_one</span><span style="color: #f8f8f2">({</span><span style="color: #e6db74">"_id"</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">ObjectId</span><span style="color: #f8f8f2">(</span><span style="color: #f8f8f2">empleado_id</span><span style="color: #f8f8f2">)})</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">:</span>
        <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">f</span><span style="color: #e6db74">"El empleado aún existe: </span><span style="color: #e6db74">{</span><span style="color: #f8f8f2">empleado</span><span style="color: #f8f8f2">[</span><span style="color: #e6db74">'nombre'</span><span style="color: #f8f8f2">]</span><span style="color: #e6db74">}</span><span style="color: #e6db74">"</span><span style="color: #f8f8f2">)</span>
    <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
        <span style="color: #f8f8f2">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">"El empleado ha sido eliminado correctamente"</span><span style="color: #f8f8f2">)</span>

<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">__name__</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">"__main__"</span><span style="color: #f8f8f2">:</span>
    <span style="color: #f8f8f2">main</span><span style="color: #f8f8f2">()</span>
</pre></div>
</body>
</html>